"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let vt="https://cdn.prod.website-files.com/66aadbd497db3d8c63799460/66f69f0aaa45e095bd2e0f3f_LOGOTIPO%20FABRICSTORE_color%201.png",D={},ja={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},N={estoresJaponeses:{width:[80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400]},estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"VARAO-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},Se=[],R=[],g=[],O=0,f="inicio",c={inicio:"",tecido:"",tipo:"",bainha:"",forma:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:""},y={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:{japaneseBlind:20,curtains:[{name:"Franzido",blackout:9,normal:8,alinhado:8},{name:"Ondas",blackout:8.5,normal:7.5,alinhado:7.5},{name:"Macho Juntos",normal:12.5,blackout:13.5,alinhado:12.5},{name:"Pregas",normal:12.5,blackout:13.5,alinhado:12.5}],towels:{circle:{normal:[{maxWidth:200,price:8},{maxWidth:280,price:10}]},square:{normal:[{maxWidth:150,price:5},{maxWidth:200,price:6},{maxWidth:250,price:8},{maxWidth:280,price:9}],cantos:[{maxWidth:150,price:6.5},{maxWidth:200,price:8},{maxWidth:250,price:10},{maxWidth:280,price:14}]},retangle:{normal:[{maxWidth:280,price:5},{maxWidth:400,price:7},{maxWidth:500,price:8.5}],cantos:[{maxWidth:280,price:8},{maxWidth:400,price:12.5},{maxWidth:500,price:14.5},{maxWidth:600,price:16.5}]}}},bainhaPrice:{price:3.5,widthMargin:20},bainhaEstoreJaponesPrice:{price:3.5,widthMargin:30},uniao:{maxLength:400,price:8.6,calha9500M:15},prolongadores:3.7,roletesPrice:5,bainhaToalhas:{normal:{price:3.5,widthMargin:10},cantos:{price:5,widthMargin:15}},maxWidthToalhasNoPriceIncrease:170,minWidthToalhas:0,maxWidthToalhas:280,minLengthToalhas:0,maxLengthToalhas:4e3,minTowelMargin:0,maxTowelMargin:75,minWindowWidthEstores:80,maxWindowWidthEstores:300,minWindowHeightEstores:80,maxWindowHeightEstores:300,maxWindowWidth:650,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},T=!0,je=document.getElementById("sim-container"),ge=document.getElementById("steps-cortina"),Ee=document.getElementById("steps-estore"),xe=document.getElementById("steps-toalha"),u={step1:document.getElementById("simulator-heading-1"),step1i:document.getElementById("inicio-description"),step1c:document.getElementById("inicio-description-c"),step1e:document.getElementById("inicio-description-e"),step2:document.getElementById("simulator-heading-2"),step2t:document.getElementById("tipo-description"),step2b:document.getElementById("bainha-description"),step2toalha:document.getElementById("simulator-heading-2-toalha"),step2f:document.getElementById("forma-description"),step2bt:document.getElementById("bainha-toalha-description"),step3:document.getElementById("simulator-heading-3"),step3m:document.getElementById("medidas-description"),step3c:document.getElementById("correcao-description"),step4:document.getElementById("simulator-heading-4"),step4c:document.getElementById("calha-description"),step4s:document.getElementById("suporte-description"),step5:document.getElementById("simulator-heading-5"),step5i:document.getElementById("instalacao-description")},l={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),forma:document.getElementById("forma-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},be=document.getElementById("largura-input-descr-c"),Ce=document.getElementById("altura-input-descr-c"),ve=document.getElementById("largura-input-descr-e"),Ie=document.getElementById("altura-input-descr-e"),b=document.getElementById("largura-input"),L=document.getElementById("altura-input"),z=document.getElementById("margem-input"),te=document.getElementById("largura-contain"),ae=document.getElementById("altura-contain"),Be=document.getElementById("margem-contain"),re=document.querySelector("#correcao-switch"),ke=document.querySelector("#bainha"),de=document.getElementById("tecto-radio-btn"),V=document.getElementById("parede-radio-btn"),ue=document.querySelector("#instalacao-switch"),Ue=document.getElementById("bainha-toalha"),Qe=document.getElementById("bainha-form"),J=document.getElementById("largura-min-error-estore"),q=document.getElementById("altura-min-error-estore"),H=document.getElementById("largura-max-error-estore"),j=document.getElementById("altura-max-error-estore"),Ge=document.getElementById("margem-min-error"),Ke=document.getElementById("margem-max-error"),oe=document.getElementById("largura-error"),se=document.getElementById("altura-error"),me=document.getElementById("seguinte-btn"),p={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao"),medidasEstore:document.getElementById("step-medidas-estore"),instalacaoEstore:document.getElementById("step-instalacao-estore"),medidasToalha:document.getElementById("step-medidas-toalha"),forma:document.getElementById("step-forma-toalha")},It=document.getElementById("form"),Te=document.getElementById("nome-input"),Le=document.getElementById("email-input"),Ze=document.getElementById("contacto-switch"),Ye=document.getElementById("checkout-container"),Bt=document.getElementById("new-window-contain"),kt=document.getElementById("checkout-input-contain"),Fe=document.getElementById("checkout-info-estore"),Me=document.getElementById("checkout-info-cortina"),Ae=document.getElementById("checkout-info-toalha"),Tt=document.getElementById("new-window-btn"),Lt=document.getElementById("no-window-btn"),$t=document.getElementById("enviar-btn"),Pt=document.getElementById("download-btn"),we=document.getElementById("enviar-btn-contain"),et=document.getElementById("download-btn-contain"),P={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao"),estoreProduto:document.getElementById("checkout-produto-estore"),estoreLargura:document.getElementById("checkout-largura-estore"),estoreAltura:document.getElementById("checkout-altura-estore"),estoreCorrecao:document.getElementById("checkout-correcao-estore"),estoreInstalacao:document.getElementById("checkout-instalacao-estore"),toalhaProduto:document.getElementById("checkout-produto-toalha"),toalhaForma:document.getElementById("checkout-forma-toalha"),toalhaBainha:document.getElementById("checkout-bainha-toalha"),toalhaLargura:document.getElementById("checkout-largura-toalha"),toalhaAltura:document.getElementById("checkout-altura-toalha"),toalhaMargem:document.getElementById("checkout-margem-toalha")},Ne=document.getElementById("feedback-div"),ze=document.getElementById("feedback-success"),ie=document.getElementById("name-error"),U=document.getElementById("email-error"),tt=document.getElementById("contacto-switch-error"),Wt=document.getElementById("cortina-radio-btn"),St=document.getElementById("estore-radio-btn"),Ft=document.getElementById("calha-radio-btn"),Mt=document.getElementById("varao-radio-btn"),At=document.getElementById("toalha-radio-btn"),Ua=document.getElementById("clear-all-btn"),he=document.getElementById("clear-all-txt"),Nt=()=>{Ba(),ca(),la(),da(),ua(),ma(),ha(),ya(),ga(),ra(),Ca(),ba(),va(),Ia(),xa(),Ea(),fa(),pa(),Ma()},zt=()=>{Ot(),Nt(),qe()},Dt=e=>{let t=0,s=0,o="",a=e.tecido.split("-"),n=a[0],d=a[1],r=e.calha?e.calha.split("-"):null,h=r?r[0]:null,W=r?r[1]:null,E=e.medidas?e.medidas.split(" X ")[0]:0;if((e.inicio==="Cortina"||e.inicio==="Estore Japon\xEAs"||e.inicio==="Toalha")&&(o=`${n}${d}`),e.inicio==="Estore"){let M=e.medidas?e.medidas.split(" X ")[1]:0;o=Jt(n,d,E,M)}if(t=typeof D[o].price=="string"?parseFloat(D[o].price):D[o].price,e.inicio==="Toalha")return{product:t,calha:0};if(e.inicio==="Estore")return{product:t,calha:0};if(e.inicio==="Estore Japon\xEAs"){let M=qt(E),Y=D[M]?typeof D[M].price=="string"?parseFloat(D[M].price):D[M].price:0;return{product:t,calha:Y}}let v=(E/y.maxCalhaWidth|0)+1,x=E<=y.maxCalhaWidth?E:E/v,A=Ht(h,e.tipo,W,x,e?.suporte==="Parede");return s=D[A]?E<y.maxCalhaWidth?D[A].price:D[A].price*v:0,s+=E>y.maxCalhaWidth?y.prolongadores*v:E>y.uniao.maxLength&&e.calha.startsWith("9500M")?y.uniao.calha9500M*v:E>y.uniao.maxLength?y.uniao.price*v:0,(A.startsWith("5000")||A.startsWith("1500"))&&(s+=E<y.maxCalhaWidth?y.roletesPrice:y.roletesPrice*v),{product:t,calha:s}},Ot=()=>{fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRnpR16s-LlJCttzFQBqDmgLYSIGtTKbBKbDGUXfvjwGHR2W3u66qn4TV8DkHr2280Oru6V4QVgFYJV/pub?output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),s=t[0].split(","),o=t.slice(1).map(n=>n.split(",")),a={};o.forEach(n=>{let[d,r]=n;a[d]||(a[d]={id:d,price:parseFloat(r)})}),D=a}).catch(e=>console.error("Error fetching CSV data:",e))},I=(e,t)=>{c[e.id.split("-")[0]]=t},De=e=>{c.calha=e},at=e=>{c.suporte=V.checked?"Parede":"Tecto"},_t=()=>{c.inicio="",c.tecido="",c.tipo="",c.bainha="",c.medidas="",c.correcao="",c.calha="",c.suporte="",c.instalacao=""},Xt=e=>{e.inicio==="Cortina"&&(I(l.inicio,e.inicio),I(l.tecido,e.tecido),I(l.tipo,e.tipo),I(l.bainha,e.bainha),I(l.medidas,e.medidas),I(l.correcao,e.correcao),I(l.suporte,e.suporte),I(l.instalacao,e.instalacao)),e.inicio.startsWith("Estore")&&(I(l.inicio,e.inicio),I(l.tecido,e.tecido),I(l.medidas,e.medidas),I(l.correcao,e.correcao),I(l.instalacao,e.instalacao))},Vt=()=>{T||(g[O].inicio=c.inicio,g[O].bainha=c.bainha,g[O].tecido=c.tecido,g[O].tipo=c.tipo,g[O].medidas=c.medidas,g[O].correcao=c.correcao,g[O].calha=c.calha,g[O].suporte=c.suporte,g[O].instalacao=c.instalacao)},ne=()=>{let e={index:g.length,inicio:c.inicio,bainha:c.bainha,forma:c.forma,tecido:c.tecido,tipo:c.tipo,medidas:c.medidas,correcao:c.correcao,calha:c.calha,suporte:c.suporte,instalacao:c.instalacao};g.push(e),T=!1},Rt=()=>{S("Cortina"),_t(),Qt(),dt(),O=g.length,ct("inicio"),T=!0},k=()=>{switch(f){case"inicio":return c.inicio===""?(m(!1),!1):(m(!0),!0);case"tecido":return c.tecido===""?(m(!1),!1):(m(!0),!0);case"tipo":return c.tipo===""?(m(!1),!1):(m(!0),!0);case"forma":return c.forma===""?(m(!1),!1):(m(!0),!0);case"medidas":if(c.inicio==="Toalha"){if(parseInt(b?.value)+parseInt(z?.value)>y.maxWidthToalhas)return Ke.style.display="block",m(!1),!1;if(parseInt(b?.value)+parseInt(z?.value)<y.minWidthToalhas)return Ge.style.display="block",m(!1),!1}return c.inicio==="Cortina"?parseInt(b?.value)>y.maxWindowWidth||parseInt(L?.value)>y.maxWindowHeight?(parseInt(b?.value)>y.maxWindowWidth?oe.style.display="block":oe.style.display="none",parseInt(L?.value)>y.maxWindowHeight?se.style.display="block":se.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):c.inicio==="Estore"?parseInt(b?.value)<y.minWindowWidthEstores||parseInt(L?.value)<y.minWindowHeightEstores?(parseInt(b?.value)<y.minWindowWidthEstores?J.style.display="block":J.style.display="none",parseInt(L?.value)<y.minWindowHeightEstores?q.style.display="block":q.style.display="none",m(!1),!1):parseInt(b?.value)>y.maxWindowWidthEstores||parseInt(L?.value)>y.maxWindowHeightEstores?(J.style.display="none",q.style.display="none",parseInt(b?.value)>y.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt(L?.value)>y.maxWindowHeightEstores?j.style.display="block":j.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):c.inicio==="Estore Japon\xEAs"?parseInt(b?.value)>y.maxWindowWidthEstores||parseInt(L?.value)>y.maxWindowHeightEstores?(J.style.display="none",q.style.display="none",parseInt(b?.value)>y.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt(L?.value)>y.maxWindowHeightEstores?j.style.display="block":j.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):(oe.style.display="none",se.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",Ke.style.display="none",Ge.style.display="none",m(!0),!0);case"calha":return c.calha===""?(m(!1),!1):(m(!0),!0);case"suporte":return c.suporte===""?(m(!1),!1):(m(!0),!0)}return m(!0),!0},Jt=(e,t,s,o)=>{let a=N.estores.width.find(d=>d>=s),n=N.estores.height.find(d=>d>=o);return`${e}${n}${a}`},qt=e=>`ROMANETE${N.estoresJaponeses.width.find(s=>s>=e)}`,Ht=(e,t,s,o,a)=>{if(t==="Ilh\xF3s"){let d=N.calhas[`${e}-${s}`]?.find(r=>r>=o);return`${e}${d}${s}`}if(e==="KS"){if(a){let r=N.calhas[e]?.find(h=>h>=o);return`${e}${t==="Franzido"?"F":"O"}${r}SP`}let d=N.calhas[e]?.find(r=>r>=o);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(a){let r=N.calhas[`${e}-${s}`]?.find(h=>h>=o);return`${e}${t==="Franzido"?"F":"O"}${r}${s}SP`}let d=N.calhas[`${e}-${s}`]?.find(r=>r>=o);return`${e}${t==="Franzido"?"F":"O"}${d}${s}`}if(e==="9500M"){if(a){let r=N.calhas[e].find(h=>h>=o);return`${e}${r}SP`}let d=N.calhas[e].find(r=>r>=o);return`${e}${d}`}if(a){let d=N.calhas[`${e}-${s}`].find(r=>r>=o);return`${e}${d}${s}SP`}let n=N.calhas[`${e}-${s}`].find(d=>d>=o);return`${e}${n}${s}`},jt=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},ot=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},Ut=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},S=e=>{e==="Toalha"&&(he?.click(),setTimeout(()=>{At?.click()},300)),e==="Estore"&&(he?.click(),setTimeout(()=>{St?.click()},300)),(e==="Cortina"||e==="Estore Japon\xEAs")&&(he?.click(),setTimeout(()=>{Wt?.click()},300)),e==="Calha"&&(he?.click(),setTimeout(()=>{Ft?.click()},300)),e==="Var\xE3o"&&(he?.click(),setTimeout(()=>{Mt?.click()},300))},Qa=()=>{window.fsAttributes=window.fsAttributes||[],window.fsAttributes.push(["cmsfilter",e=>{console.log("cmsfilter Successfully loaded!");let[t]=e;t.listInstance.on("renderitems",s=>{console.log(s)})}])},Qt=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),s=document.querySelectorAll("[id^='tecido-card']"),o=document.querySelectorAll(".tecido_color");e.forEach(a=>{_(a)}),t.forEach(a=>{_(a)}),s.forEach(a=>{_(a)}),o.forEach(a=>{Re(a)}),b.value="",L.value="",re.checked=!1,ue.checked=!1,V?.click(),ke.checked=!1},st=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?G(s):_(s)})},Oe=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(s=>{ot(s).split("-")[0].startsWith(e.split("-")[0])?G(s):_(s)})},Gt=e=>{document.querySelectorAll("[id^='tipo-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?G(s):_(s)})},Kt=e=>{e==="Parede"?V.click():de.click()},it=()=>{de.checked=!1,V.checked=!1},K=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(g.length===1&&(g[0].button=e,ut(g[0])),g.length>1&&e){let s=e.cloneNode(!0);s.querySelector(".checkout_info_title").textContent=`Janela ${g.length}`,g[g.length-1].button=s,ut(g[g.length-1]),t?.appendChild(s)}},Zt=e=>{e.inicio==="Cortina"&&(st(e.inicio),Oe(e.tecido),Gt(e.tipo),ke.checked=e.bainha,b.value=e.medidas.split(" X ")[0],L.value=e.medidas.split(" X ")[1],re.checked=e.correcao,Kt(e.suporte),ue.checked=e.instalacao),e.inicio.startsWith("Estore")&&(st(e.inicio),Oe(e.tecido),b.value=e.medidas.split(" X ")[0],L.value=e.medidas.split(" X ")[1],re.checked=e.correcao,ue.checked=e.instalacao)},C=e=>{e==="inicio"&&(u.step1i.style.display="flex",u.step1c.style.display="none",u.step1e.style.display="none"),e==="tecido"&&c.inicio==="Cortina"&&(u.step1i.style.display="none",u.step1c.style.display="flex",u.step1e.style.display="none"),e==="tecido"&&c.inicio==="Estore"&&(u.step1i.style.display="none",u.step1c.style.display="none",u.step1e.style.display="flex"),e==="tipo"&&(u.step2t.style.display="flex",u.step2b.style.display="none"),e==="bainha"&&c.inicio==="Cortina"&&(u.step2t.style.display="none",u.step2b.style.display="flex"),e==="forma"&&(u.step2bt.style.display="none",u.step2f.style.display="flex"),e==="bainha"&&c.inicio==="Toalha"&&(u.step2bt.style.display="flex",u.step2f.style.display="none"),e==="medidas"&&(u.step3m.style.display="flex",u.step3c.style.display="none"),e==="correcao"&&(u.step3m.style.display="none",u.step3c.style.display="flex"),e==="calha"&&(u.step4c.style.display="flex",u.step4s.style.display="none"),e==="suporte"&&(u.step4c.style.display="none",u.step4s.style.display="flex"),e==="instalacao"&&(u.step5.style.display="flex")},Yt=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e===f)return;let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||e==="medidasEstore"||c.inicio==="Estore")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura"||e==="medidasEstore")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),p[e].classList.contains("done")){switch(ia(f),i(u[Ut(f)],!1),i(f==="calha"?l.tecido:l[f],!1),C(e),e){case"tecido":c.inicio==="Estore Japon\xEAs"?S("Cortina"):S(t?"Estore":"Cortina"),i(u.step1,!0),i(l.tecido,!0);break;case"tipo":i(u.step2,!0),i(l.tipo,!0);break;case"medidas":i(u.step3,!0),i(l.medidas,!0);break;case"calha":c.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),i(u.step4,!0),i(l.tecido,!0);break;case"instalacao":i(u.step5,!0),i(l.instalacao,!0);break}f=e,k(),F(e)}},_e=()=>{c.inicio==="Toalha"?(c.forma==="Quadrada"||c.forma==="Redonda"?(te&&(te.style.display="flex"),ae&&(ae.style.display="none")):(te&&(te.style.display="flex"),ae&&(ae.style.display="flex")),Be&&(Be.style.display="flex")):(te&&(te.style.display="flex"),ae&&(ae.style.display="flex"),Be&&(Be.style.display="none"))},Xe=()=>{c.inicio==="Cortina"&&(be.style.display="block",Ce.style.display="block",ve.style.display="none",Ie.style.display="none"),(c.inicio==="Estore"||c.inicio==="Estore Japon\xEAs")&&(be.style.display="none",Ce.style.display="none",ve.style.display="block",Ie.style.display="block"),c.inicio==="Toalha"&&(c.forma==="Quadrada"||c.forma==="Redonda")?(be.style.display="none",Ce.style.display="none",ve.style.display="block",Ie.style.display="none"):c.inicio==="Toalha"&&(be.style.display="none",Ce.style.display="none",ve.style.display="block",Ie.style.display="block")},wt=()=>{if(c.inicio==="Cortina")switch(f){case"inicio":k()&&(S(c.inicio),Q("Cortina"),i(l.inicio,!1),C("tecido"),T&&m(!1),i(l.tecido,!0),f="tecido");break;case"tecido":k()&&(C("tecido"),$("tecido"),F("tipo"),i(u.step1,!1),T&&m(!1),i(l.tecido,!1),C("tipo"),i(u.step2,!0),i(l.tipo,!0),Xe(),_e(),f="tipo");break;case"tipo":k()&&(i(l.tipo,!1),c.tecido.startsWith("9")?(I(l.bainha,!0),T&&m(!1),$("tipo"),F("medidas"),i(u.step2,!1),C("medidas"),i(u.step3,!0),i(l.medidas,!0),f="medidas"):(C("bainha"),i(l.bainha,!0),f="bainha"));break;case"bainha":I(l.bainha,`${c.tecido.startsWith("9")?!0:c.bainha?c.bainha:!1}`),$("tipo"),F("medidas"),i(u.step2,!1),i(l.bainha,!1),T&&m(!1),C("medidas"),i(u.step3,!0),i(l.medidas,!0),f="medidas";break;case"medidas":k()&&(I(l.medidas,`${b?.value} X ${L?.value}`),i(l.medidas,!1),g.length>0?(T&&m(!1),c.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),i(u.step3,!1),C("calha"),i(u.step4,!0),i(l.tecido,!0),f="calha"):(C("correcao"),i(l.correcao,!0),f="correcao"));break;case"correcao":c.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),i(u.step3,!1),i(l.correcao,!1),T&&m(!1),C("calha"),i(u.step4,!0),i(l.tecido,!0),f="calha";break;case"calha":k()&&(i(l.tecido,!1),c.tipo==="Ilh\xF3s"?(m(!0),i(u.step4,!1),C("instalacao"),i(u.step5,!0),i(l.instalacao,!0),f="instalacao"):(T&&m(!1),it(),C("suporte"),i(l.suporte,!0),f="suporte"));break;case"suporte":I(l.suporte,V?.checked?"Parede":"Tecto"),k()&&($("calha"),F("instalacao"),i(u.step4,!1),i(l.suporte,!1),C("instalacao"),g.length>0?(T&&(ne(),K()),Z()):(i(u.step5,!0),i(l.instalacao,!0),f="instalacao"));break;case"instalacao":$("instalacao"),i(u.step5,!1),i(l.instalacao,!1),T&&(ne(),K()),Z();break}else if(c.inicio==="Toalha")switch(f){case"inicio":k()&&(Q("Toalha"),i(l.inicio,!1),C("tecido"),T&&m(!1),i(l.tecido,!0),f="tecido");break;case"tecido":k()&&(C("tecido"),$("tecido"),F("forma"),i(u.step1,!1),T&&m(!1),i(l.tecido,!1),C("forma"),i(u.step2toalha,!0),i(l.forma,!0),f="forma");break;case"forma":k()&&(i(l.forma,!1),Xe(),_e(),T&&m(!1),c.forma==="Redonda"?(c.bainha="Ba\xEDnha Normal",$("forma"),F("medidas"),i(u.step2toalha,!1),i(u.step3,!0),i(l.medidas,!0),C("medidas"),f="medidas"):(i(l.bainha,!0),f="bainha"));break;case"bainha":$("forma"),F("medidas"),i(u.step2toalha,!1),i(l.bainha,!1),T&&m(!1),C("medidas"),i(u.step3,!0),i(l.medidas,!0),f="medidas";break;case"medidas":k()&&(c.inicio==="Toalha"&&(c.forma==="Quadrada"||c.forma==="Redonda")?I(l.medidas,`${b?.value} X ${b?.value} X ${z?.value}`):I(l.medidas,`${b?.value} X ${L?.value} X ${z?.value}`),i(l.medidas,!1),i(u.step3,!1),$("medidasToalha"),T&&(ne(),K()),Z());break;case"correcao":c.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),i(u.step3,!1),i(l.correcao,!1),T&&m(!1),C("calha"),i(u.step4,!0),i(l.tecido,!0),f="calha";break;case"calha":k()&&(i(l.tecido,!1),c.tipo==="Ilh\xF3s"?(m(!0),i(u.step4,!1),C("instalacao"),i(u.step5,!0),i(l.instalacao,!0),f="instalacao"):(T&&m(!1),it(),C("suporte"),i(l.suporte,!0),f="suporte"));break;case"suporte":I(l.suporte,V?.checked?"Parede":"Tecto"),k()&&($("calha"),F("instalacao"),i(u.step4,!1),i(l.suporte,!1),C("instalacao"),g.length>0?(T&&(ne(),K()),Z()):(i(u.step5,!0),i(l.instalacao,!0),f="instalacao"));break;case"instalacao":$("instalacao"),i(u.step5,!1),i(l.instalacao,!1),T&&(ne(),K()),Z();break}else switch(f){case"inicio":k()&&(Q("Estore"),i(l.inicio,!1),C("tecido"),T&&m(!1),i(l.tecido,!0),f="tecido");break;case"tecido":k()&&($("tecido"),F("medidas"),i(u.step1,!1),i(l.tecido,!1),Xe(),_e(),T&&m(!1),C("medidas"),i(u.step3,!0),i(l.medidas,!0),f="medidas");break;case"medidas":k()&&(i(l.medidas,!1),g.length>0?($("medidas"),F("instalacao"),i(u.step3,!1),C("instalacao"),i(u.step5,!0),i(l.instalacao,!0),f="instalacao"):(C("correcao"),i(l.correcao,!0),f="correcao"));break;case"correcao":$("medidas"),F("instalacao"),i(u.step3,!1),i(l.correcao,!1),g.length>0?(K(),Z()):(i(u.step5,!0),i(l.instalacao,!0),f="instalacao");break;case"instalacao":$("instalacao"),i(u.step5,!1),i(l.instalacao,!1),T&&(ne(),K()),Z();break}},Z=()=>{T||Vt(),je.style.display="none",nt(g[g.length-1]),Q(""),Ye.style.display="flex"},ea=e=>{e.inicio==="Cortina"&&(Me.style.display="flex",Fe.style.display="none",Ae.style.display="none",P.tecido.textContent=e.tecido,P.tipo.textContent=e.tipo,P.bainha.textContent=e.tipo==="Ondas"||e.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",P.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",P.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",P.correcao.textContent=g[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",P.calha.textContent=e.calha,P.suporte.textContent="Suporte de "+e.suporte,P.instalacao.textContent=g[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio.startsWith("Estore")&&(Fe.style.display="flex",Me.style.display="none",Ae.style.display="none",P.estoreProduto.textContent=e.tecido,P.estoreLargura.textContent=e.medidas.split(" X ")[0]+"cm",P.estoreAltura.textContent=e.medidas.split(" X ")[1]+"cm",P.estoreCorrecao.textContent=g[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",P.estoreInstalacao.textContent=g[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio==="Toalha"&&(Ae.style.display="flex",Me.style.display="none",Fe.style.display="none",P.toalhaProduto.textContent=e.tecido,P.toalhaForma.textContent=e.forma,P.toalhaBainha.textContent=e.bainha,P.toalhaLargura.textContent=e.medidas.split(" X ")[0]+"cm",P.toalhaAltura.textContent=e.medidas.split(" X ")[1]+"cm",P.toalhaMargem.textContent=e.medidas.split(" X ")[2]+"cm")},ta=e=>{e.inicio==="Cortina"&&($("tecido"),$("tipo"),$("medidas"),$("calha"),$("instalacao")),e.inicio.startsWith("Estore")&&($("tecido"),$("medidas"),$("instalacao"))},nt=e=>{g.forEach(t=>{t.button&&t.button.classList.remove("active")}),O=e.index,T=!1,e.button.classList.add("active"),ea(e),Xt(e),Zt(e),ta(e)},ct=e=>{Ye.style.display="none",T&&dt(),Q(""),je.style.display="flex";let t=!1,s=!1;switch((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||c.inicio==="Estore")&&(t=!0),c.inicio==="Toalha"&&(s=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura")&&(e="medidas"),(e==="estoreCorrecao"||e==="correcao")&&(e="medidas"),(e==="estoreInstalacao"||e==="instalacao")&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),Q(t?"Estore":s?"Toalha":"Cortina"),e){case"inicio":C("inicio"),i(u.step1,!0),i(l.inicio,!0);break;case"tecido":c.inicio==="Estore Japon\xEAs"?S("Cortina"):S(t?"Estore":"Cortina"),setTimeout(()=>{},2e3),Oe(c.tecido),C("tecido"),i(u.step1,!0),i(l.tecido,!0);break;case"tipo":C("tipo"),i(u.step2,!0),i(l.tipo,!0);break;case"toalhaProduto":S("Toalha"),C("tecido"),i(u.step1,!0),i(l.tecido,!0);break;case"toalhaForma":C("forma"),i(u.step2toalha,!0),i(l.forma,!0);break;case"toalhaMedidas":C("medidas"),i(u.step3,!0),i(l.medidas,!0);break;case"medidas":C("medidas"),i(u.step3,!0),i(l.medidas,!0);break;case"calha":c.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),C("calha"),i(u.step4,!0),i(l.tecido,!0);break;case"suporte":C("suporte"),i(u.step4,!0),i(l.suporte,!0);break;case"instalacao":C("instalacao"),i(u.step5,!0),i(l.instalacao,!0);break}if(f=e,f==="inicio")return F("tecido");f==="toalhaProduto"&&(f="tecido"),t&&((e==="medidas"||e==="correcao")&&F("medidasEstore"),e==="instalacao"&&F("instalacaoEstore")),T=!1,F(e)},Ga=async e=>{let t=Buffer.from(e,"base64"),o=await(await PDFDocument.load(t)).save();return Buffer.from(o).toString("base64")},Ka=async e=>await(await fetch(e)).arrayBuffer(),aa=(e,t,s,o,a,n,d)=>{let r=n.getPageCount(),h="www.fabricstore.pt",W=n.getPages();W.forEach(E=>{let x=`Pag. ${W.indexOf(E)+1} de ${r}`,A=d.widthOfTextAtSize(x,8),M=(E.getWidth()-A)/2;E.drawLine({start:{x:a,y:e-4*t},end:{x:s,y:e-4*t},thickness:.5,color:o(0,0,0)}),E.drawText(h,{x:a,y:e-5*t,size:10,fontReg:d}),E.drawText(x,{x:M,y:e-5*t,size:8,fontReg:d})})},lt=async()=>{let{PDFDocument:e,rgb:t}=PDFLib,s=await e.create(),o=s.addPage([595.28,841.89]),a=800,n=50,d=520,r=12,h=3,W=0,E=100,v=await s.embedFont(PDFLib.StandardFonts.Helvetica),x=await s.embedFont(PDFLib.StandardFonts.HelveticaBold),A=a,M=null;try{M=await oa(vt);let B=await fetch(M).then(ee=>ee.arrayBuffer()),X=await s.embedPng(B),{width:Ct,height:ce}=X.scale(1),le=100,ye=ce/Ct*le,Pe=(o.getWidth()-le)/2;o.drawImage(X,{x:Pe,y:A-10,width:le,height:ye})}catch(B){console.error("Error loading logo:",B)}let Y="Cliente:",$e="Data:",ft="Email:",yt=new Date().toLocaleDateString(),_a=x.widthOfTextAtSize(Y,8),gt=x.widthOfTextAtSize($e,8),Xa=x.widthOfTextAtSize(ft,8),Va=v.widthOfTextAtSize(yt,8);o.drawText(Y,{x:n,y:A,size:8,font:x}),o.drawText(`${c.nome}`,{x:n+_a+2,y:A,size:8,font:v});let Ra=gt+Va+2,Et=d-Ra;o.drawText($e,{x:Et,y:A,size:8,font:x}),o.drawText(yt,{x:Et+gt+2,y:A,size:8,font:v});let w=A-r;o.drawText(ft,{x:n,y:w,size:8,font:x}),o.drawText(`${c.email}`,{x:n+Xa+2,y:w,size:8,font:v}),a=w-r*2,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:n,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,g.forEach(async(B,X)=>{(a<264+E&&B.inicio==="Cortina"||a<102+E&&B.inicio.startsWith("Estore"))&&(o=s.addPage([595.28,841.89]),a=800,a=w-r*2,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:n,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r);let{usedWidth:Ct,tecido:ce,calha:le,instalacao:ye,total:Pe}=mt(B);W+=Pe;let ee=[];B.inicio==="Toalha"&&(o.drawText(`Toalha ${X+1} -`,{x:n,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:n+x.widthOfTextAtSize(`Janela ${X+1} -`,8),y:a,size:8,font:v}),a-=r,ee=[{label:"Toalha",price:ce,subItems:[{label:`Tipo de tecido: ${B.tecido}`},{label:`Forna da toalha: ${B.tipo}`},{label:`Ba\xEDnha: ${B.bainha}`}]}]),B.inicio==="Cortina"&&(o.drawText(`Janela ${X+1} -`,{x:n,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:n+x.widthOfTextAtSize(`Janela ${X+1} -`,8),y:a,size:8,font:v}),a-=r,ee=[{label:"Cortinado",price:ce,subItems:[{label:`Tipo de tecido: ${B.tecido}`},{label:`Modelo de cortina: ${B.tipo}`},{label:`Ba\xEDnha de chumbo: ${B.tecido.startsWith("9")?"Inclu\xEDda":B.bainha?"Sim":"N\xE3o"}`}]},{label:`${B.tipo==="Ilh\xF3s"?"Var\xE3o":"Calha"}`,price:le,subItems:[{label:`${B.tipo==="Ilh\xF3s"?"Modelo de var\xE3o":"Modelo de calha"}: ${B.calha}`},{label:`${B.tipo==="Ilh\xF3s"?"Suporte de var\xE3o":"Suporte da calha"}: ${B.tipo==="Ilh\xF3s"?"Parede":B.suporte}`}]},{label:"Instala\xE7\xE3o",price:ye,subItems:[]}]),B.inicio==="Estore"&&(o.drawText(`Janela ${X+1} -`,{x:n,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:n+x.widthOfTextAtSize(`Janela ${X+1} -`,8),y:a,size:8,font:v}),a-=r,ee=[{label:"Estore",price:ce,subItems:[{label:`Modelo de estore: ${B.tecido}`}]},{label:"Instala\xE7\xE3o",price:ye,subItems:[]}]),B.inicio==="Estore Japon\xEAs"&&(o.drawText(`Janela ${X+1} -`,{x:n,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:n+x.widthOfTextAtSize(`Janela ${X+1} -`,8),y:a,size:8,font:v}),a-=r,ee=[{label:"Estore Japon\xEAs",price:ce+le,subItems:[{label:`Modelo de estore: ${B.tecido}`}]},{label:"Instala\xE7\xE3o",price:ye,subItems:[]}]),ee.forEach(We=>{o.drawText(`  - ${We.label}`,{x:n,y:a,size:8,font:x}),o.drawText(`${We.price.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:v}),a-=r,We.subItems.forEach(Ha=>{o.drawText(`      \u2022 ${Ha.label}`,{x:n+20,y:a,size:8,font:v}),a-=r}),a-=r}),o.drawText("Total",{x:n,y:a,size:8,font:x}),o.drawText(`${Pe.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontReg:v}),a-=r,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r}),a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=w-r*2,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:n,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r);let Ja=g[0].correcao?"Sim":"Facultadas pelo cliente";o.drawText("Retifica\xE7\xE3o de medidas:",{x:n,y:a,size:8,font:x}),o.drawText(Ja,{x:n+x.widthOfTextAtSize("Retifica\xE7\xE3o de medidas:",8)+2,y:a,size:8,font:v});let xt=g[0].correcao?30:0;W+=xt,o.drawText(`${xt.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:v}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r*2,a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=w-r*2,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:n,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r),o.drawText("Total:",{x:d-150,y:a,size:10,font:x}),o.drawText(`${W.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontBold:x}),a<108+E&&(o=s.addPage([595.28,841.89]),a=800,a=w-r*2,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:n,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:n,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r),a-=r*4,o.drawText("Observa\xE7\xF5es:",{x:n,y:a,size:10,font:x});let pe="\u2022 ",fe=10;o.drawText(`${pe}Valores com IVA incluido \xE0 taxa em vigor. Or\xE7amento v\xE1lido por 15 dias.`,{x:n+fe,y:a-r,size:8,font:v}),o.drawText(`${pe}Calhas j\xE1 incluem os rod\xEDzios e suportes necess\xE1rios para as medidas selecionadas.`,{x:n+fe,y:a-2*r,size:8,font:v}),o.drawText(`${pe}Valor referente \xE0 instala\xE7\xE3o e rectifica\xE7\xE3o de medidas sujeito a valida\xE7\xE3o do c\xF3digo postal.`,{x:n+fe,y:a-3*r,size:8,font:v}),o.drawText(`${pe}Valor da Rectifica\xE7\xE3o de Medidas \xE9 deduzido do or\xE7amento na adjudica\xE7\xE3o do mesmo.`,{x:n+fe,y:a-4*r,size:8,font:v}),o.drawText(`${pe}IBAN: PT50 0007 0000 0041 4543 3722 3`,{x:n+fe,y:a-5*r,size:8,font:v}),aa(E,r,d,t,n,s,v);let qa=await s.save(),bt=new Blob([qa],{type:"application/pdf"}),He=document.createElement("a");return He.href=URL.createObjectURL(bt),He.download="Orcamento_Fabric-Store.pdf",{blob:bt,pdfDoc:s,link:He}},rt=async()=>{let e=0,t="";t+=`Data: ${new Date().toLocaleDateString()}

`,t+=`Cliente: ${c.nome}

`,t+=`Email: ${c.email}

`;let s=g[0].correcao?"  Sim:":"  Facultadas pelo cliente:",o=g[0].correcao?30:0;return g.forEach((n,d)=>{let{usedWidth:r,tecido:h,calha:W,instalacao:E,total:v}=mt(n);e+=v,n.inicio==="Cortina"&&(t+=`Janela ${d+1} - ${n.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Cortinado: ${h.toFixed(2)}\u20AC
`,t+=`    Tipo de tecido: ${n.tecido}
`,t+=`    Modelo de Cortina: ${n.tipo}
`,t+=`    Ba\xEDnha de chumbo: ${n.tecido.startsWith("9")?"Inclu\xEDda":n.bainha?"Sim":"N\xE3o"}

`,t+=`  Calha: ${W.toFixed(2)}\u20AC
`,t+=`    Modelo de calha: ${n.tipo}
`,t+=`    Suporte da calha: ${n.suporte}

`),n.inicio==="Estore"&&(t+=`Janela ${d+1} - ${n.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Estore: ${h.toFixed(2)}\u20AC
`,t+=`    Modelo de estore: ${n.tecido}

`),n.inicio==="Estore Japon\xEAs"&&(t+=`Janela ${d+1} - ${n.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Estore: ${parseFloat(h.toFixed(2))+parseFloat(W.toFixed(2))}\u20AC
`,t+=`    Modelo de estore: ${n.tecido}

`),n.inicio==="Toalha"&&(t+=`Toalha ${d+1} - ${n.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Toalha: ${h.toFixed(2)}\u20AC
`,t+=`    Tecido: ${n.tecido}
`,t+=`    Forma: ${n.forma}
`,t+=`    Largura: ${n.medidas.split(" X ")[0]}cm
`,t+=`    Altura: ${n.medidas.split(" X ")[1]}cm
`,t+=`    Margem: ${n.medidas.split(" X ")[2]}cm
`),t+=`  Instala\xE7\xE3o: ${E.toFixed(2)}\u20AC

`}),t+=`Retifica\xE7\xE3o de medidas:
${s} ${o.toFixed(2)}\u20AC

`,e+=o,t+=`Total: ${e.toFixed(2)}\u20AC

`,new Blob([t],{type:"text/plain"})},oa=e=>new Promise((t,s)=>{let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{let a=document.createElement("canvas");a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0);let d=a.toDataURL("image/png");t(d)},o.onerror=a=>{s(new Error(`Failed to load image from ${e}: ${a.message}`))}}),Q=e=>{e||(ge.style.display="none",Ee.style.display="none",xe.style.display="none"),e==="Cortina"&&(ge.style.display="flex",Ee.style.display="none",xe.style.display="none"),e==="Estore"&&(ge.style.display="none",Ee.style.display="flex",xe.style.display="none"),e==="Toalha"&&(ge.style.display="none",Ee.style.display="none",xe.style.display="flex")},sa=()=>{gsap.registerPlugin(ScrollToPlugin),gsap.to(window,{duration:1,scrollTo:{y:0},ease:"power2.inOut"})},i=(e,t)=>{t?gsap.fromTo(e,{opacity:0},{opacity:1,duration:.8,delay:.2,ease:"power2.inOut",onStart:()=>{e.style.display="flex"}}):gsap.to(e,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>{e.style.display="none",sa()}})},dt=()=>{Object.keys(p).forEach(e=>{p[e].classList.remove("active"),p[e].classList.add("next"),p[e].classList.remove("done"),p[e].getElementsByClassName("step_number")[0].classList.remove("active"),p[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},$=e=>{p[e].classList.remove("active"),p[e].classList.remove("next"),p[e].classList.add("done"),p[e].getElementsByClassName("step_number")[0].classList.remove("active"),p[e].getElementsByClassName("step_description")[0].classList.contains("next")&&p[e].getElementsByClassName("step_description")[0].classList.remove("next"),p[e].getElementsByClassName("step_description")[0].textContent=c[e],e==="instala\xE7\xE3o"&&(p.instalacaoEstore?.classList.remove("active"),p.instalacaoEstore?.classList.remove("next"),p.instalacaoEstore?.classList.add("done"),p.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),p.instalacaoEstore.getElementsByClassName("step_description")[0].textContent=c.instalacao?"c/Instala\xE7\xE3o":"s/Instala\xE7\xE3o"),e==="medidas"&&(g.length>0?p[e].getElementsByClassName("step_description")[0].innerHTML+=g[0].correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o":p[e].getElementsByClassName("step_description")[0].innerHTML+=c.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o",p.medidasEstore?.classList.remove("active"),p.medidasEstore?.classList.remove("next"),p.medidasEstore?.classList.add("done"),p.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),p.medidasEstore.getElementsByClassName("step_description")[0].textContent=`${b?.value} X ${L?.value}cm`,p.medidasEstore.getElementsByClassName("step_description")[0].innerHTML+=`${c.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o"}`),e==="medidasToalha"&&(p.medidasToalha?.classList.remove("active"),p.medidasToalha?.classList.remove("next"),p.medidasToalha?.classList.add("done"),p.medidasToalha?.getElementsByClassName("step_number")[0].classList.remove("active"),c.forma==="Redonda"||c.forma==="Quadrada"?p.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${b?.value} X ${b?.value} X ${z?.value} cm`:p.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${b?.value} X ${L?.value} X ${z?.value} cm`),e==="tipo"&&(p[e].getElementsByClassName("step_description")[0].innerHTML+=`${c.bainha?"<br>c/Ba\xEDnha de Chumbo":"<br>s/Ba\xEDnha de Chumbo"}`)},F=e=>{let t=e==="toalhaProduto"?"tecido":e;p[t].classList.remove("next"),p[t].classList.add("active"),p[t].getElementsByClassName("step_number")[0].classList.add("active"),t==="instalacao"&&(p.instalacaoEstore?.classList.remove("next"),p.instalacaoEstore?.classList.add("active"),p.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.add("active")),t==="medidas"&&(p.medidasEstore?.classList.remove("next"),p.medidasEstore?.classList.add("active"),p.medidasEstore?.getElementsByClassName("step_number")[0].classList.add("active"))},ia=e=>{let t=e;if(t==="suporte"&&(t="calha"),p[t].classList.contains("active")&&(p[t].classList.remove("active"),p[t].getElementsByClassName("step_number")[0].classList.remove("active")),t==="instalacao"&&(p.instalacaoEstore?.classList.remove("active"),p.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),t==="medidas"&&(p.medidasEstore?.classList.remove("active"),p.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),!T||k())return $(t);p[t].classList.add("next"),p[t].querySelector("step_description")&&!p[t].querySelector("step_description")[0].classList.contains("next")&&p[t].querySelector("step_description")[0].classList.add("next"),t==="instalacao"&&p.instalacaoEstore?.classList.add("next"),t==="medidas"&&p.medidasEstore?.classList.add("next")},m=e=>{e&&me?.classList.contains("inactive")&&me.classList.remove("inactive"),e||me?.classList.contains("inactive")||me.classList.add("inactive")},Ve=e=>{e.classList.add("active")},Re=e=>{e.classList.remove("active")},G=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),s.classList.add("active")},_=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),s.classList.remove("active")},Za=e=>{e.classList.add("show"),gsap.fromTo(e,{opacity:0},{opacity:1,duration:1,ease:"power1.in"})},Ya=e=>{e.classList.add("show"),gsap.fromTo(e,{x:-100,opacity:0},{x:0,opacity:1,duration:1,ease:"power1.inOut"})},wa=(e,t=0)=>{gsap.fromTo(e.map(s=>`#${s}`),{opacity:0,x:-300},{opacity:1,x:0,duration:1,ease:"power1.inOut",stagger:t})},na=e=>{e==="Toalha"?(Ue.style.display="flex",Qe.style.display="none"):(Ue.style.display="none",Qe.style.display="block")},ca=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.getElementsByTagName("h1")[0].textContent;G(t),e.forEach(o=>{o!==t&&_(o)}),S(s),na(s),I(l.inicio,s),k()&&m(!0)})})},la=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(s=>{s.addEventListener("click",()=>{let o=ot(s),a=jt(s),n=Se.find(r=>r.product===o),d=s.getElementsByClassName("tecido_color");if(t.forEach(r=>Re(r)),G(s,l.tecido),e.forEach(r=>{r!==s&&_(r)}),n){for(let r=0;r<d.length;r++)d.item(r).id===`${n.color}`&&Ve(d.item(r));f==="tecido"&&I(l.tecido,n.color),f==="calha"&&De(n.color)}else d.length>0&&Ve(d[0]),f==="tecido"&&a!==""&&I(l.tecido,`${a}`),f==="calha"&&a!==""&&De(a);k()&&m(!0)})})},ra=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",s=>{let o=s.currentTarget,a=o&&o.id;Ve(o),e.forEach(h=>{h!==o&&Re(h)});let n=a?a.split("-")[0]:"",d=Se.find(h=>h.product===n);d?d.color=`${a}`:Se.push({product:n,color:`${a}`});let r=o.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let h=0;h<e.length;h++)if(e[h].getAttribute("id")===a){let W=e[h].querySelector(".source");W?r.setAttribute("src",W.getAttribute("src")):r.setAttribute("src",e[h].getElementsByTagName("img")[0].getAttribute("src")),r.setAttribute("srcset","");break}return f==="calha"&&a!==""?De(a):f==="tecido"&&a!==""?I(l.tecido,a):console.log("No color was stored")})})},da=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t,l.tipo),e.forEach(s=>{s!==t&&_(s)}),I(l.tipo,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ua=()=>{let e=document.querySelectorAll("[id^='forma-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t),e.forEach(s=>{s!==t&&_(s)}),I(l.forma,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ma=()=>{let e=document.querySelectorAll("[id^='bainha-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t),e.forEach(s=>{s!==t&&_(s)}),I(l.bainha,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ha=()=>{ke.addEventListener("change",function(e){I(l.bainha,ke.checked)})},pa=()=>{V?.addEventListener("change",e=>{(V?.checked===!0||de?.checked===!0)&&(at("Parede"),k()&&m(!0))}),de?.addEventListener("change",e=>{(V?.checked===!0||de?.checked===!0)&&(at("Tecto"),k()&&m(!0))})},fa=()=>{z?.addEventListener("input",e=>{if(c.inicio==="Toalha"){if(c.forma==="Quadrada"||c.forma==="Redonda"){if(b?.value===""||z?.value===""){m(!1);return}}else if(b?.value===""||L?.value===""||z?.value===""){m(!1);return}}else if(b?.value===""||L?.value===""){m(!1);return}k()&&I(l.medidas,`${b?.value} X ${L?.value}`),b?.value!==""&&L?.value!==""&&(k()?m(!0):m(!1))}),b?.addEventListener("input",e=>{if(c.inicio==="Toalha"){if(c.forma==="Quadrada"||c.forma==="Redonda"){if(b?.value===""||z?.value===""){m(!1);return}}else if(b?.value===""||L?.value===""||z?.value===""){m(!1);return}}else if(b?.value===""||L?.value===""){m(!1);return}k()&&I(l.medidas,`${b?.value} X ${L?.value}`),b?.value!==""&&L?.value!==""&&(k()?m(!0):m(!1))}),L?.addEventListener("input",e=>{if(c.inicio==="Toalha"){if(b?.value===""||L?.value===""||z?.value===""){m(!1);return}}else if(b?.value===""||L?.value===""){m(!1);return}k()&&I(l.medidas,`${b?.value} X ${L?.value}`),b?.value!==""&&L?.value!==""&&(k()?m(!0):m(!1))})},ya=()=>{re.addEventListener("change",function(e){I(l.correcao,re.checked)})},ga=()=>{ue.addEventListener("change",function(e){I(l.instalacao,ue.checked)})},Ea=()=>{Object.keys(p).forEach(e=>{p[e].addEventListener("click",()=>{Yt(e)})})},xa=()=>{Object.keys(P).forEach(e=>{P[e].addEventListener("click",()=>{e==="correcao"||e==="estoreCorrecao"||e!=="suporte"&&e!=="bainha"&&ct(e)})})},ut=e=>{e.button.addEventListener("click",()=>{nt(e)})},ba=()=>{Pt.addEventListener("click",async()=>{c.nome=Te.value,c.email=Le.value,c.contacto=Ze.checked;let e=await rt();Da(e);let{blob:t,pdfDoc:s,link:o}=await lt();R.push({blob:t,pdf:s,link:o}),R[R.length-1].link.click()})},Ca=()=>{$t.addEventListener("click",async()=>{c.nome=Te.value,c.email=Le.value,c.contacto=Ze.checked;let{blob:e,pdfDoc:t,link:s}=await lt();R.push({blob:e,pdf:t,link:s});let o=await rt();await Oa(c.nome,c.email,c.contacto?"Aceita":"N\xE3o aceita",R[R.length-1].blob,o,R[R.length-1].link)})},va=()=>{Tt.addEventListener("click",Rt)},Ia=()=>{Lt.addEventListener("click",()=>{Bt.style.display="none",kt.style.display="flex"})},Ba=()=>{me.addEventListener("click",wt)},ka=e=>{if(e.inicio==="Toalha"){let s=e.medidas.split(" X "),[o,a,n]=s.map(W=>parseInt(W)),d=Math.max(o,a),r=Math.min(o,a),h=e.bainha.includes("Cantos")?y.bainhaToalhas.cantos.widthMargin:y.bainhaToalhas.normal.widthMargin;return d+2*n+h<=y.maxWidthToalhas?r+2*n+h:d+2*n+h}if(e.inicio==="Estore Japon\xEAs")return e.medidas?parseInt(e.medidas.split(" X ")[0]):0;let t=y.usedWidths.find(s=>e.tipo===s.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+y.bainhaPrice.widthMargin:0},Ta=(e,t)=>{let s=e.medidas.split(" X ")[0],o=0,a=0,n=Dt(e);return e.inicio==="Toalha"&&(o=n.product*(t/100)),e.inicio==="Cortina"&&(o=n.product*(t/100),a=n.calha),e.inicio==="Estore"&&(o=n.product),e.inicio==="Estore Japon\xEAs"&&(o=n.product*((t+y.bainhaEstoreJaponesPrice.widthMargin)/100),a=n.calha),{product:o,calha:a}},La=(e,t)=>{if(e.inicio==="Toalha"){let o=e.forma==="Redonda"?"circle":e.forma==="Quadrada"?"square":"retangle",a=e.bainha.includes("Cantos")?"cantos":"normal",n=y.manufacturingPrices.towels[o][a],d=n.find(M=>t<=M.maxWidth),r=e.medidas.split(" X "),[h,W,E]=r.map(M=>parseInt(M)),v=Math.max(h,W),x=Math.min(h,W),A=e.bainha.includes("Cantos")?y.bainhaToalhas.cantos.widthMargin:y.bainhaToalhas.normal.widthMargin;if(x+2*E+A<=y.maxWidthToalhasNoPriceIncrease)return d?d.price:0;{let M=n.findIndex($e=>t<=$e.maxWidth),Y=M+1<n.length?n[M+1]:n[M];return Y?Y.price:0}return d?d.price:0}if(e.inicio==="Estore")return 0;if(e.inicio==="Estore Japon\xEAs"){let o=e.medidas.split(" X ")[0],a=e.medidas.split(" X ")[1],n=parseInt(o)/100*(parseInt(a)/100);return n?n*y.manufacturingPrices.japaneseBlind:0}let s=y.manufacturingPrices.curtains.find(o=>e.tipo===o.name);return s?e.tecido.startsWith("8")?s.blackout*(t/100):e.tecido.startsWith("9")&&(e.tipo==="Ondas"||e.tipo==="Franzido")?s.alinhado*(t/100):s.normal*(t/100):0},$a=(e,t)=>e.inicio==="Toalha"||e.inicio==="Cortina"&&e.tecido.startsWith("9")||e.inicio.startsWith("Estore")?0:e.bainha?y.bainhaPrice.price*(t/100):0,eo=e=>e.inicio==="Toalha"?0:e.correcao?y.measuresCheckPrice:0,Pa=e=>{if(e.inicio==="Toalha"||!g[0].instalacao)return 0;let t=0,s=parseInt(e.medidas.split(" X ")[0]),o=y.instalation.find(a=>s<=a.maxWidth);return o&&(t=o.price),o&&e.inicio==="Cortina"&&e.calha.startsWith("9500")&&(t*=2),t||0},mt=e=>{let t=ka(e),s=Ta(e,t),o=La(e,t),a=$a(e,t),n=Pa(e),d=s.product+o+a+s.calha+n;return e.totalPrice=d,{usedWidth:t,tecido:s.product+o+a,calha:s.calha,instalacao:n,total:d}},Wa=e=>{let t=e.indexOf("@");return t>0&&t<e.length-1},Je=e=>new Promise((t,s)=>{let o=new FileReader;o.onloadend=()=>t(o.result),o.onerror=s,o.readAsDataURL(e)}),Sa=()=>Te.value.trim()===""?(ie.textContent="Preencher este campo obrigat\xF3rio",ie.classList.add("u-text-main"),!0):(ie.textContent="",ie.classList.remove("u-text-main"),!1),Fa=()=>{let e=Le.value.trim();return e===""?(U.textContent="Preencher este campo obrigat\xF3rio",U.classList.add("u-text-main"),!0):Wa(e)?(U.textContent="",U.classList.remove("u-text-main"),!1):(U.textContent="Insira um email v\xE1lido",U.classList.add("u-text-main"),!0)},qe=()=>{Aa();let e=Sa(),t=Fa();Na(e||t),za(e||t)},Ma=()=>{Te?.addEventListener("input",qe),Le?.addEventListener("input",qe)},Aa=()=>{ie.textContent="",U.textContent="",tt.textContent="",ie.classList.remove("u-text-main"),U.classList.remove("u-text-main"),tt.classList.remove("u-text-main")},Na=e=>{e&&we?.classList.add("inactive"),e||we?.classList.remove("inactive")},za=e=>{e&&et?.classList.add("inactive"),e||et?.classList.remove("inactive")},Da=async e=>{let t=null;try{let o=await e;t=await Je(o)}catch{console.error("Failed to load txt"),t=null}let s={name:c.nome,email:c.email,check:c.contacto?"Aceita":"N\xE3o aceita",file:t,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_txt",s).then(function(o){console.log("TXT DL SUCCESS!",o.status,o.text)},function(o){console.log("TXT DL FAILED...",o)})},Oa=async(e,t,s,o,a,n)=>{let d=null,r=null;try{let E=await o,v=await a;d=await Je(E),r=await Je(v)}catch{console.error("Failed to load PDF"),d=null}let h={name:e,email:t,check:s,file:d,to_company_email:"contact@fabricstore.pt",to_user_email:t,reply_to:"contact@fabricstore.pt"},W={name:e,email:t,check:s,file:r,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_pdf",h).then(function(E){console.log("PDF EMAIL SUCCESS!",E.status,E.text),It.style.display="none",Ne.style.display="none",ze.textContent="Obrigado pelo seu contacto!",ze.style.display="block"},function(E){console.log("PDF EMAIL FAILED...",E),ze.style.display="none",Ne.textContent="Aconteceu um erro durante o envio. Tente novamente ou entre em contacto connosco.",Ne.style.display="block"}),emailjs.send("service_fabricstore","template_quote_txt",W).then(function(E){console.log("TXT SUCCESS!",E.status,E.text)},function(E){console.log("TXT FAILED...",E)})},ht={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},pt=new Swiper(".swiper",ht),to=()=>{pt.destroy(),pt=new Swiper(".swiper",ht)};zt()});})();
