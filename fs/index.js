"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let vt="https://cdn.prod.website-files.com/66aadbd497db3d8c63799460/66f69f0aaa45e095bd2e0f3f_LOGOTIPO%20FABRICSTORE_color%201.png",M={},Ha={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},A={estoresJaponeses:{width:[80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400]},estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"VARAO-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},We=[],V=[],f=[],D=0,y="inicio",n={inicio:"",tecido:"",tipo:"",bainha:"",forma:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:""},g={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:{japaneseBlind:20,curtains:[{name:"Franzido",blackout:9,normal:8,alinhado:8},{name:"Ondas",blackout:8.5,normal:7.5,alinhado:7.5},{name:"Macho Juntos",normal:12.5,blackout:13.5,alinhado:12.5},{name:"Pregas",normal:12.5,blackout:13.5,alinhado:12.5}],towels:{circle:{normal:[{maxWidth:200,price:8},{maxWidth:280,price:10}]},square:{normal:[{maxWidth:150,price:5},{maxWidth:200,price:6},{maxWidth:250,price:8},{maxWidth:280,price:9}],cantos:[{maxWidth:150,price:6.5},{maxWidth:200,price:8},{maxWidth:250,price:10},{maxWidth:280,price:14}]},retangle:{normal:[{maxWidth:280,price:5},{maxWidth:400,price:7},{maxWidth:500,price:8.5}],cantos:[{maxWidth:280,price:8},{maxWidth:400,price:12.5},{maxWidth:500,price:14.5},{maxWidth:600,price:16.5}]}}},bainhaPrice:{price:3.5,widthMargin:20},bainhaEstoreJaponesPrice:{price:3.5,widthMargin:30},uniao:{maxLength:400,price:8.6,calha9500M:15},prolongadores:3.7,roletesPrice:5,bainhaToalhas:{normal:{price:3.5,widthMargin:10},cantos:{price:5,widthMargin:20}},minWidthToalhas:0,maxWidthToalhas:280,minLengthToalhas:0,maxLengthToalhas:4e3,minTowelMargin:0,maxTowelMargin:75,minWindowWidthEstores:80,maxWindowWidthEstores:300,minWindowHeightEstores:80,maxWindowHeightEstores:300,maxWindowWidth:650,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},T=!0,He=document.getElementById("sim-container"),Ee=document.getElementById("steps-cortina"),xe=document.getElementById("steps-estore"),be=document.getElementById("steps-toalha"),u={step1:document.getElementById("simulator-heading-1"),step1i:document.getElementById("inicio-description"),step1c:document.getElementById("inicio-description-c"),step1e:document.getElementById("inicio-description-e"),step2:document.getElementById("simulator-heading-2"),step2t:document.getElementById("tipo-description"),step2b:document.getElementById("bainha-description"),step2toalha:document.getElementById("simulator-heading-2-toalha"),step2f:document.getElementById("forma-description"),step2bt:document.getElementById("bainha-toalha-description"),step3:document.getElementById("simulator-heading-3"),step3m:document.getElementById("medidas-description"),step3c:document.getElementById("correcao-description"),step4:document.getElementById("simulator-heading-4"),step4c:document.getElementById("calha-description"),step4s:document.getElementById("suporte-description"),step5:document.getElementById("simulator-heading-5"),step5i:document.getElementById("instalacao-description")},r={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),forma:document.getElementById("forma-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},Ce=document.getElementById("largura-input-descr-c"),ve=document.getElementById("altura-input-descr-c"),Be=document.getElementById("largura-input-descr-e"),Ie=document.getElementById("altura-input-descr-e"),x=document.getElementById("largura-input"),$=document.getElementById("altura-input"),z=document.getElementById("margem-input"),ee=document.getElementById("largura-contain"),te=document.getElementById("altura-contain"),ke=document.getElementById("margem-contain"),de=document.querySelector("#correcao-switch"),Te=document.querySelector("#bainha"),ue=document.getElementById("tecto-radio-btn"),R=document.getElementById("parede-radio-btn"),me=document.querySelector("#instalacao-switch"),je=document.getElementById("bainha-toalha"),Ue=document.getElementById("bainha-form"),J=document.getElementById("largura-min-error-estore"),q=document.getElementById("altura-min-error-estore"),H=document.getElementById("largura-max-error-estore"),j=document.getElementById("altura-max-error-estore"),Qe=document.getElementById("margem-min-error"),Ge=document.getElementById("margem-max-error"),ae=document.getElementById("largura-error"),oe=document.getElementById("altura-error"),he=document.getElementById("seguinte-btn"),h={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao"),medidasEstore:document.getElementById("step-medidas-estore"),instalacaoEstore:document.getElementById("step-instalacao-estore"),medidasToalha:document.getElementById("step-medidas-toalha"),forma:document.getElementById("step-forma-toalha")},Bt=document.getElementById("form"),se=document.getElementById("nome-input"),ie=document.getElementById("email-input"),Ke=document.getElementById("contacto-switch"),Ze=document.getElementById("checkout-container"),It=document.getElementById("new-window-contain"),kt=document.getElementById("checkout-input-contain"),Se=document.getElementById("checkout-info-estore"),Fe=document.getElementById("checkout-info-cortina"),Oe=document.getElementById("checkout-info-toalha"),Tt=document.getElementById("new-window-btn"),$t=document.getElementById("no-window-btn"),Lt=document.getElementById("enviar-btn"),Pt=document.getElementById("download-btn"),Ye=document.getElementById("enviar-btn-contain"),we=document.getElementById("download-btn-contain"),P={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao"),estoreProduto:document.getElementById("checkout-produto-estore"),estoreLargura:document.getElementById("checkout-largura-estore"),estoreAltura:document.getElementById("checkout-altura-estore"),estoreCorrecao:document.getElementById("checkout-correcao-estore"),estoreInstalacao:document.getElementById("checkout-instalacao-estore"),toalhaProduto:document.getElementById("checkout-produto-toalha"),toalhaForma:document.getElementById("checkout-forma-toalha"),toalhaBainha:document.getElementById("checkout-bainha-toalha"),toalhaLargura:document.getElementById("checkout-largura-toalha"),toalhaAltura:document.getElementById("checkout-altura-toalha"),toalhaMargem:document.getElementById("checkout-margem-toalha")},Ae=document.getElementById("feedback-div"),ze=document.getElementById("feedback-success"),ne=document.getElementById("name-error"),U=document.getElementById("email-error"),et=document.getElementById("contacto-switch-error"),Wt=document.getElementById("cortina-radio-btn"),St=document.getElementById("estore-radio-btn"),Ft=document.getElementById("calha-radio-btn"),Ot=document.getElementById("varao-radio-btn"),At=document.getElementById("toalha-radio-btn"),ja=document.getElementById("clear-all-btn"),pe=document.getElementById("clear-all-txt"),zt=()=>{Ia(),ca(),ra(),da(),ua(),ma(),ha(),ya(),ga(),la(),Ca(),ba(),va(),Ba(),xa(),Ea(),fa(),pa(),Oa()},Mt=()=>{Xt(),zt(),Je()},Dt=e=>{let t=0,s=0,o="",a=e.tecido.split("-"),c=a[0],d=a[1],l=e.calha?e.calha.split("-"):null,p=l?l[0]:null,F=l?l[1]:null,E=e.medidas?e.medidas.split(" X ")[0]:0;if((e.inicio==="Cortina"||e.inicio==="Estore Japon\xEAs"||e.inicio==="Toalha")&&(o=`${c}${d}`),e.inicio==="Estore"){let _=e.medidas?e.medidas.split(" X ")[1]:0;o=Jt(c,d,E,_)}if(t=typeof M[o].price=="string"?parseFloat(M[o].price):M[o].price,e.inicio==="Toalha")return{product:t,calha:0};if(e.inicio==="Estore")return{product:t,calha:0};if(e.inicio==="Estore Japon\xEAs"){let _=qt(E),$e=M[_]?typeof M[_].price=="string"?parseFloat(M[_].price):M[_].price:0;return{product:t,calha:$e}}let v=(E/g.maxCalhaWidth|0)+1,C=E<=g.maxCalhaWidth?E:E/v,O=Ht(p,e.tipo,F,C,e?.suporte==="Parede");return s=M[O]?E<g.maxCalhaWidth?M[O].price:M[O].price*v:0,s+=E>g.maxCalhaWidth?g.prolongadores*v:E>g.uniao.maxLength&&e.calha.startsWith("9500M")?g.uniao.calha9500M*v:E>g.uniao.maxLength?g.uniao.price*v:0,(O.startsWith("5000")||O.startsWith("1500"))&&(s+=E<g.maxCalhaWidth?g.roletesPrice:g.roletesPrice*v),{product:t,calha:s}},Xt=()=>{fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRnpR16s-LlJCttzFQBqDmgLYSIGtTKbBKbDGUXfvjwGHR2W3u66qn4TV8DkHr2280Oru6V4QVgFYJV/pub?output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),s=t[0].split(","),o=t.slice(1).map(c=>c.split(",")),a={};o.forEach(c=>{let[d,l]=c;a[d]||(a[d]={id:d,price:parseFloat(l)})}),M=a}).catch(e=>console.error("Error fetching CSV data:",e))},B=(e,t)=>{n[e.id.split("-")[0]]=t},Me=e=>{n.calha=e},tt=e=>{n.suporte=R.checked?"Parede":"Tecto"},_t=()=>{n.inicio="",n.tecido="",n.tipo="",n.bainha="",n.medidas="",n.correcao="",n.calha="",n.suporte="",n.instalacao=""},Nt=e=>{e.inicio==="Cortina"&&(B(r.inicio,e.inicio),B(r.tecido,e.tecido),B(r.tipo,e.tipo),B(r.bainha,e.bainha),B(r.medidas,e.medidas),B(r.correcao,e.correcao),B(r.suporte,e.suporte),B(r.instalacao,e.instalacao)),e.inicio.startsWith("Estore")&&(B(r.inicio,e.inicio),B(r.tecido,e.tecido),B(r.medidas,e.medidas),B(r.correcao,e.correcao),B(r.instalacao,e.instalacao))},Rt=()=>{T||(f[D].inicio=n.inicio,f[D].bainha=n.bainha,f[D].tecido=n.tecido,f[D].tipo=n.tipo,f[D].medidas=n.medidas,f[D].correcao=n.correcao,f[D].calha=n.calha,f[D].suporte=n.suporte,f[D].instalacao=n.instalacao)},ce=()=>{let e={index:f.length,inicio:n.inicio,bainha:n.bainha,forma:n.forma,tecido:n.tecido,tipo:n.tipo,medidas:n.medidas,correcao:n.correcao,calha:n.calha,suporte:n.suporte,instalacao:n.instalacao};f.push(e),T=!1},Vt=()=>{W("Cortina"),_t(),Qt(),lt(),D=f.length,nt("inicio"),T=!0},k=()=>{switch(y){case"inicio":return n.inicio===""?(m(!1),!1):(m(!0),!0);case"tecido":return n.tecido===""?(m(!1),!1):(m(!0),!0);case"tipo":return n.tipo===""?(m(!1),!1):(m(!0),!0);case"forma":return n.forma===""?(m(!1),!1):(m(!0),!0);case"medidas":if(n.inicio==="Toalha"){if(parseInt(x?.value)+parseInt(z?.value)>g.maxWidthToalhas)return Ge.style.display="block",m(!1),!1;if(parseInt(x?.value)+parseInt(z?.value)<g.minWidthToalhas)return Qe.style.display="block",m(!1),!1}return n.inicio==="Cortina"?parseInt(x?.value)>g.maxWindowWidth||parseInt($?.value)>g.maxWindowHeight?(parseInt(x?.value)>g.maxWindowWidth?ae.style.display="block":ae.style.display="none",parseInt($?.value)>g.maxWindowHeight?oe.style.display="block":oe.style.display="none",m(!1),!1):(ae.style.display="none",oe.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):n.inicio==="Estore"?parseInt(x?.value)<g.minWindowWidthEstores||parseInt($?.value)<g.minWindowHeightEstores?(parseInt(x?.value)<g.minWindowWidthEstores?J.style.display="block":J.style.display="none",parseInt($?.value)<g.minWindowHeightEstores?q.style.display="block":q.style.display="none",m(!1),!1):parseInt(x?.value)>g.maxWindowWidthEstores||parseInt($?.value)>g.maxWindowHeightEstores?(J.style.display="none",q.style.display="none",parseInt(x?.value)>g.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt($?.value)>g.maxWindowHeightEstores?j.style.display="block":j.style.display="none",m(!1),!1):(ae.style.display="none",oe.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):n.inicio==="Estore Japon\xEAs"?parseInt(x?.value)>g.maxWindowWidthEstores||parseInt($?.value)>g.maxWindowHeightEstores?(J.style.display="none",q.style.display="none",parseInt(x?.value)>g.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt($?.value)>g.maxWindowHeightEstores?j.style.display="block":j.style.display="none",m(!1),!1):(ae.style.display="none",oe.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",m(!0),!0):(ae.style.display="none",oe.style.display="none",J.style.display="none",q.style.display="none",H.style.display="none",j.style.display="none",Ge.style.display="none",Qe.style.display="none",m(!0),!0);case"calha":return n.calha===""?(m(!1),!1):(m(!0),!0);case"suporte":return n.suporte===""?(m(!1),!1):(m(!0),!0)}return m(!0),!0},Jt=(e,t,s,o)=>{let a=A.estores.width.find(d=>d>=s),c=A.estores.height.find(d=>d>=o);return`${e}${c}${a}`},qt=e=>`ROMANETE${A.estoresJaponeses.width.find(s=>s>=e)}`,Ht=(e,t,s,o,a)=>{if(t==="Ilh\xF3s"){let d=A.calhas[`${e}-${s}`]?.find(l=>l>=o);return`${e}${d}${s}`}if(e==="KS"){if(a){let l=A.calhas[e]?.find(p=>p>=o);return`${e}${t==="Franzido"?"F":"O"}${l}SP`}let d=A.calhas[e]?.find(l=>l>=o);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(a){let l=A.calhas[`${e}-${s}`]?.find(p=>p>=o);return`${e}${t==="Franzido"?"F":"O"}${l}${s}SP`}let d=A.calhas[`${e}-${s}`]?.find(l=>l>=o);return`${e}${t==="Franzido"?"F":"O"}${d}${s}`}if(e==="9500M"){if(a){let l=A.calhas[e].find(p=>p>=o);return`${e}${l}SP`}let d=A.calhas[e].find(l=>l>=o);return`${e}${d}`}if(a){let d=A.calhas[`${e}-${s}`].find(l=>l>=o);return`${e}${d}${s}SP`}let c=A.calhas[`${e}-${s}`].find(d=>d>=o);return`${e}${c}${s}`},jt=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},at=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},Ut=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},W=e=>{e==="Toalha"&&(pe?.click(),setTimeout(()=>{At?.click()},300)),e==="Estore"&&(pe?.click(),setTimeout(()=>{St?.click()},300)),(e==="Cortina"||e==="Estore Japon\xEAs")&&(pe?.click(),setTimeout(()=>{Wt?.click()},300)),e==="Calha"&&(pe?.click(),setTimeout(()=>{Ft?.click()},300)),e==="Var\xE3o"&&(pe?.click(),setTimeout(()=>{Ot?.click()},300))},Ua=()=>{window.fsAttributes=window.fsAttributes||[],window.fsAttributes.push(["cmsfilter",e=>{console.log("cmsfilter Successfully loaded!");let[t]=e;t.listInstance.on("renderitems",s=>{console.log(s)})}])},Qt=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),s=document.querySelectorAll("[id^='tecido-card']"),o=document.querySelectorAll(".tecido_color");e.forEach(a=>{X(a)}),t.forEach(a=>{X(a)}),s.forEach(a=>{X(a)}),o.forEach(a=>{Re(a)}),x.value="",$.value="",de.checked=!1,me.checked=!1,R?.click(),Te.checked=!1},ot=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?G(s):X(s)})},De=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(s=>{at(s).split("-")[0].startsWith(e.split("-")[0])?G(s):X(s)})},Gt=e=>{document.querySelectorAll("[id^='tipo-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?G(s):X(s)})},Kt=e=>{e==="Parede"?R.click():ue.click()},st=()=>{ue.checked=!1,R.checked=!1},K=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(f.length===1&&(f[0].button=e,dt(f[0])),f.length>1&&e){let s=e.cloneNode(!0);s.querySelector(".checkout_info_title").textContent=`Janela ${f.length}`,f[f.length-1].button=s,dt(f[f.length-1]),t?.appendChild(s)}},Zt=e=>{e.inicio==="Cortina"&&(ot(e.inicio),De(e.tecido),Gt(e.tipo),Te.checked=e.bainha,x.value=e.medidas.split(" X ")[0],$.value=e.medidas.split(" X ")[1],de.checked=e.correcao,Kt(e.suporte),me.checked=e.instalacao),e.inicio.startsWith("Estore")&&(ot(e.inicio),De(e.tecido),x.value=e.medidas.split(" X ")[0],$.value=e.medidas.split(" X ")[1],de.checked=e.correcao,me.checked=e.instalacao)},b=e=>{e==="inicio"&&(u.step1i.style.display="flex",u.step1c.style.display="none",u.step1e.style.display="none"),e==="tecido"&&n.inicio==="Cortina"&&(u.step1i.style.display="none",u.step1c.style.display="flex",u.step1e.style.display="none"),e==="tecido"&&n.inicio==="Estore"&&(u.step1i.style.display="none",u.step1c.style.display="none",u.step1e.style.display="flex"),e==="tipo"&&(u.step2t.style.display="flex",u.step2b.style.display="none"),e==="bainha"&&n.inicio==="Cortina"&&(u.step2t.style.display="none",u.step2b.style.display="flex"),e==="forma"&&(u.step2bt.style.display="none",u.step2f.style.display="flex"),e==="bainha"&&n.inicio==="Toalha"&&(u.step2bt.style.display="flex",u.step2f.style.display="none"),e==="medidas"&&(u.step3m.style.display="flex",u.step3c.style.display="none"),e==="correcao"&&(u.step3m.style.display="none",u.step3c.style.display="flex"),e==="calha"&&(u.step4c.style.display="flex",u.step4s.style.display="none"),e==="suporte"&&(u.step4c.style.display="none",u.step4s.style.display="flex"),e==="instalacao"&&(u.step5.style.display="flex")},Yt=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e===y)return;let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||e==="medidasEstore"||n.inicio==="Estore")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura"||e==="medidasEstore")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),h[e].classList.contains("done")){switch(ia(y),i(u[Ut(y)],!1),i(y==="calha"?r.tecido:r[y],!1),b(e),e){case"tecido":n.inicio==="Estore Japon\xEAs"?W("Cortina"):W(t?"Estore":"Cortina"),i(u.step1,!0),i(r.tecido,!0);break;case"tipo":i(u.step2,!0),i(r.tipo,!0);break;case"medidas":i(u.step3,!0),i(r.medidas,!0);break;case"calha":n.tipo==="Ilh\xF3s"?W("Var\xE3o"):W("Calha"),i(u.step4,!0),i(r.tecido,!0);break;case"instalacao":i(u.step5,!0),i(r.instalacao,!0);break}y=e,k(),S(e)}},Xe=()=>{n.inicio==="Toalha"?(n.forma==="Quadrada"||n.forma==="Redonda"?(ee&&(ee.style.display="flex"),te&&(te.style.display="none")):(ee&&(ee.style.display="flex"),te&&(te.style.display="flex")),ke&&(ke.style.display="flex")):(ee&&(ee.style.display="flex"),te&&(te.style.display="flex"),ke&&(ke.style.display="none"))},_e=()=>{n.inicio==="Cortina"&&(Ce.style.display="block",ve.style.display="block",Be.style.display="none",Ie.style.display="none"),(n.inicio==="Estore"||n.inicio==="Estore Japon\xEAs")&&(Ce.style.display="none",ve.style.display="none",Be.style.display="block",Ie.style.display="block"),n.inicio==="Toalha"&&(n.forma==="Quadrada"||n.forma==="Redonda")?(Ce.style.display="none",ve.style.display="none",Be.style.display="block",Ie.style.display="none"):n.inicio==="Toalha"&&(Ce.style.display="none",ve.style.display="none",Be.style.display="block",Ie.style.display="block")},wt=()=>{if(n.inicio==="Cortina")switch(y){case"inicio":k()&&(W(n.inicio),Q("Cortina"),i(r.inicio,!1),b("tecido"),T&&m(!1),i(r.tecido,!0),y="tecido");break;case"tecido":k()&&(b("tecido"),L("tecido"),S("tipo"),i(u.step1,!1),T&&m(!1),i(r.tecido,!1),b("tipo"),i(u.step2,!0),i(r.tipo,!0),_e(),Xe(),y="tipo");break;case"tipo":k()&&(i(r.tipo,!1),n.tecido.startsWith("9")?(B(r.bainha,!0),T&&m(!1),L("tipo"),S("medidas"),i(u.step2,!1),b("medidas"),i(u.step3,!0),i(r.medidas,!0),y="medidas"):(b("bainha"),i(r.bainha,!0),y="bainha"));break;case"bainha":B(r.bainha,`${n.tecido.startsWith("9")?!0:n.bainha?n.bainha:!1}`),L("tipo"),S("medidas"),i(u.step2,!1),i(r.bainha,!1),T&&m(!1),b("medidas"),i(u.step3,!0),i(r.medidas,!0),y="medidas";break;case"medidas":k()&&(B(r.medidas,`${x?.value} X ${$?.value}`),i(r.medidas,!1),f.length>0?(T&&m(!1),n.tipo==="Ilh\xF3s"?W("Var\xE3o"):W("Calha"),L("medidas"),S("calha"),i(u.step3,!1),b("calha"),i(u.step4,!0),i(r.tecido,!0),y="calha"):(b("correcao"),i(r.correcao,!0),y="correcao"));break;case"correcao":n.tipo==="Ilh\xF3s"?W("Var\xE3o"):W("Calha"),L("medidas"),S("calha"),i(u.step3,!1),i(r.correcao,!1),T&&m(!1),b("calha"),i(u.step4,!0),i(r.tecido,!0),y="calha";break;case"calha":k()&&(i(r.tecido,!1),n.tipo==="Ilh\xF3s"?(m(!0),i(u.step4,!1),b("instalacao"),i(u.step5,!0),i(r.instalacao,!0),y="instalacao"):(T&&m(!1),st(),b("suporte"),i(r.suporte,!0),y="suporte"));break;case"suporte":B(r.suporte,R?.checked?"Parede":"Tecto"),k()&&(L("calha"),S("instalacao"),i(u.step4,!1),i(r.suporte,!1),b("instalacao"),f.length>0?(T&&(ce(),K()),Z()):(i(u.step5,!0),i(r.instalacao,!0),y="instalacao"));break;case"instalacao":L("instalacao"),i(u.step5,!1),i(r.instalacao,!1),T&&(ce(),K()),Z();break}else if(n.inicio==="Toalha")switch(y){case"inicio":k()&&(Q("Toalha"),i(r.inicio,!1),b("tecido"),T&&m(!1),i(r.tecido,!0),y="tecido");break;case"tecido":k()&&(b("tecido"),L("tecido"),S("forma"),i(u.step1,!1),T&&m(!1),i(r.tecido,!1),b("forma"),i(u.step2toalha,!0),i(r.forma,!0),y="forma");break;case"forma":k()&&(i(r.forma,!1),b("forma"),i(r.bainha,!0),_e(),Xe(),y="bainha");break;case"bainha":L("forma"),S("medidas"),i(u.step2toalha,!1),i(r.bainha,!1),T&&m(!1),b("medidas"),i(u.step3,!0),i(r.medidas,!0),y="medidas";break;case"medidas":k()&&(n.inicio==="Toalha"&&(n.forma==="Quadrada"||n.forma==="Redonda")?B(r.medidas,`${x?.value} X ${x?.value} X ${z?.value}`):B(r.medidas,`${x?.value} X ${$?.value} X ${z?.value}`),i(r.medidas,!1),i(u.step3,!1),L("medidasToalha"),T&&(ce(),K()),Z());break;case"correcao":n.tipo==="Ilh\xF3s"?W("Var\xE3o"):W("Calha"),L("medidas"),S("calha"),i(u.step3,!1),i(r.correcao,!1),T&&m(!1),b("calha"),i(u.step4,!0),i(r.tecido,!0),y="calha";break;case"calha":k()&&(i(r.tecido,!1),n.tipo==="Ilh\xF3s"?(m(!0),i(u.step4,!1),b("instalacao"),i(u.step5,!0),i(r.instalacao,!0),y="instalacao"):(T&&m(!1),st(),b("suporte"),i(r.suporte,!0),y="suporte"));break;case"suporte":B(r.suporte,R?.checked?"Parede":"Tecto"),k()&&(L("calha"),S("instalacao"),i(u.step4,!1),i(r.suporte,!1),b("instalacao"),f.length>0?(T&&(ce(),K()),Z()):(i(u.step5,!0),i(r.instalacao,!0),y="instalacao"));break;case"instalacao":L("instalacao"),i(u.step5,!1),i(r.instalacao,!1),T&&(ce(),K()),Z();break}else switch(y){case"inicio":k()&&(Q("Estore"),i(r.inicio,!1),b("tecido"),T&&m(!1),i(r.tecido,!0),y="tecido");break;case"tecido":k()&&(L("tecido"),S("medidas"),i(u.step1,!1),i(r.tecido,!1),_e(),Xe(),T&&m(!1),b("medidas"),i(u.step3,!0),i(r.medidas,!0),y="medidas");break;case"medidas":k()&&(i(r.medidas,!1),f.length>0?(L("medidas"),S("instalacao"),i(u.step3,!1),b("instalacao"),i(u.step5,!0),i(r.instalacao,!0),y="instalacao"):(b("correcao"),i(r.correcao,!0),y="correcao"));break;case"correcao":L("medidas"),S("instalacao"),i(u.step3,!1),i(r.correcao,!1),f.length>0?(K(),Z()):(i(u.step5,!0),i(r.instalacao,!0),y="instalacao");break;case"instalacao":L("instalacao"),i(u.step5,!1),i(r.instalacao,!1),T&&(ce(),K()),Z();break}},Z=()=>{T||Rt(),He.style.display="none",it(f[f.length-1]),Q(""),Ze.style.display="flex"},ea=e=>{e.inicio==="Cortina"&&(Fe.style.display="flex",Se.style.display="none",Oe.style.display="none",P.tecido.textContent=e.tecido,P.tipo.textContent=e.tipo,P.bainha.textContent=e.tipo==="Ondas"||e.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",P.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",P.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",P.correcao.textContent=f[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",P.calha.textContent=e.calha,P.suporte.textContent="Suporte de "+e.suporte,P.instalacao.textContent=f[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio.startsWith("Estore")&&(Se.style.display="flex",Fe.style.display="none",Oe.style.display="none",P.estoreProduto.textContent=e.tecido,P.estoreLargura.textContent=e.medidas.split(" X ")[0]+"cm",P.estoreAltura.textContent=e.medidas.split(" X ")[1]+"cm",P.estoreCorrecao.textContent=f[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",P.estoreInstalacao.textContent=f[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio==="Toalha"&&(Oe.style.display="flex",Fe.style.display="none",Se.style.display="none",P.toalhaProduto.textContent=e.tecido,P.toalhaForma.textContent=e.forma,P.toalhaBainha.textContent=e.bainha,P.toalhaLargura.textContent=e.medidas.split(" X ")[0]+"cm",P.toalhaAltura.textContent=e.medidas.split(" X ")[1]+"cm",P.toalhaMargem.textContent=e.medidas.split(" X ")[2]+"cm")},ta=e=>{e.inicio==="Cortina"&&(L("tecido"),L("tipo"),L("medidas"),L("calha"),L("instalacao")),e.inicio.startsWith("Estore")&&(L("tecido"),L("medidas"),L("instalacao"))},it=e=>{f.forEach(t=>{t.button&&t.button.classList.remove("active")}),D=e.index,T=!1,e.button.classList.add("active"),ea(e),Nt(e),Zt(e),ta(e)},nt=e=>{Ze.style.display="none",T&&lt(),Q(""),He.style.display="flex";let t=!1,s=!1;switch((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||n.inicio==="Estore")&&(t=!0),n.inicio==="Toalha"&&(s=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura")&&(e="medidas"),(e==="estoreCorrecao"||e==="correcao")&&(e="medidas"),(e==="estoreInstalacao"||e==="instalacao")&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),Q(t?"Estore":s?"Toalha":"Cortina"),e){case"inicio":b("inicio"),i(u.step1,!0),i(r.inicio,!0);break;case"tecido":n.inicio==="Estore Japon\xEAs"?W("Cortina"):W(t?"Estore":"Cortina"),setTimeout(()=>{},2e3),De(n.tecido),b("tecido"),i(u.step1,!0),i(r.tecido,!0);break;case"tipo":b("tipo"),i(u.step2,!0),i(r.tipo,!0);break;case"toalhaProduto":W("Toalha"),b("tecido"),i(u.step1,!0),i(r.tecido,!0);break;case"toalhaForma":b("forma"),i(u.step2toalha,!0),i(r.forma,!0);break;case"toalhaMedidas":b("medidas"),i(u.step3,!0),i(r.medidas,!0);break;case"medidas":b("medidas"),i(u.step3,!0),i(r.medidas,!0);break;case"calha":n.tipo==="Ilh\xF3s"?W("Var\xE3o"):W("Calha"),b("calha"),i(u.step4,!0),i(r.tecido,!0);break;case"suporte":b("suporte"),i(u.step4,!0),i(r.suporte,!0);break;case"instalacao":b("instalacao"),i(u.step5,!0),i(r.instalacao,!0);break}if(y=e,y==="inicio")return S("tecido");y==="toalhaProduto"&&(y="tecido"),t&&((e==="medidas"||e==="correcao")&&S("medidasEstore"),e==="instalacao"&&S("instalacaoEstore")),T=!1,S(e)},Qa=async e=>{let t=Buffer.from(e,"base64"),o=await(await PDFDocument.load(t)).save();return Buffer.from(o).toString("base64")},Ga=async e=>await(await fetch(e)).arrayBuffer(),aa=(e,t,s,o,a,c,d)=>{let l=c.getPageCount(),p="www.fabricstore.pt",F=c.getPages();F.forEach(E=>{let C=`Pag. ${F.indexOf(E)+1} de ${l}`,O=d.widthOfTextAtSize(C,8),_=(E.getWidth()-O)/2;E.drawLine({start:{x:a,y:e-4*t},end:{x:s,y:e-4*t},thickness:.5,color:o(0,0,0)}),E.drawText(p,{x:a,y:e-5*t,size:10,fontReg:d}),E.drawText(C,{x:_,y:e-5*t,size:8,fontReg:d})})},ct=async()=>{let{PDFDocument:e,rgb:t}=PDFLib,s=await e.create(),o=s.addPage([595.28,841.89]),a=800,c=50,d=520,l=12,p=3,F=0,E=100,v=await s.embedFont(PDFLib.StandardFonts.Helvetica),C=await s.embedFont(PDFLib.StandardFonts.HelveticaBold),O=a,_=null;try{_=await oa(vt);let I=await fetch(_).then(w=>w.arrayBuffer()),N=await s.embedPng(I),{width:Ct,height:re}=N.scale(1),le=100,ge=re/Ct*le,Le=(o.getWidth()-le)/2;o.drawImage(N,{x:Le,y:O-10,width:le,height:ge})}catch(I){console.error("Error loading logo:",I)}let $e="Cliente:",pt="Data:",ft="Email:",yt=new Date().toLocaleDateString(),Xa=C.widthOfTextAtSize($e,8),gt=C.widthOfTextAtSize(pt,8),_a=C.widthOfTextAtSize(ft,8),Na=v.widthOfTextAtSize(yt,8);o.drawText($e,{x:c,y:O,size:8,font:C}),o.drawText(`${n.nome}`,{x:c+Xa+2,y:O,size:8,font:v});let Ra=gt+Na+2,Et=d-Ra;o.drawText(pt,{x:Et,y:O,size:8,font:C}),o.drawText(yt,{x:Et+gt+2,y:O,size:8,font:v});let Y=O-l;o.drawText(ft,{x:c,y:Y,size:8,font:C}),o.drawText(`${n.email}`,{x:c+_a+2,y:Y,size:8,font:v}),a=Y-l*2,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:C}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:C}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,f.forEach(async(I,N)=>{(a<264+E&&I.inicio==="Cortina"||a<102+E&&I.inicio.startsWith("Estore"))&&(o=s.addPage([595.28,841.89]),a=800,a=Y-l*2,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:C}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:C}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l);let{usedWidth:Ct,tecido:re,calha:le,instalacao:ge,total:Le}=ut(I);F+=Le;let w=[];I.inicio==="Toalha"&&(o.drawText(`Toalha ${N+1} -`,{x:c,y:a,size:8,font:C}),o.drawText(` ${I.medidas} CM`,{x:c+C.widthOfTextAtSize(`Janela ${N+1} -`,8),y:a,size:8,font:v}),a-=l,w=[{label:"Toalha",price:re,subItems:[{label:`Tipo de tecido: ${I.tecido}`},{label:`Forna da toalha: ${I.tipo}`},{label:`Ba\xEDnha: ${I.bainha}`}]}]),I.inicio==="Cortina"&&(o.drawText(`Janela ${N+1} -`,{x:c,y:a,size:8,font:C}),o.drawText(` ${I.medidas} CM`,{x:c+C.widthOfTextAtSize(`Janela ${N+1} -`,8),y:a,size:8,font:v}),a-=l,w=[{label:"Cortinado",price:re,subItems:[{label:`Tipo de tecido: ${I.tecido}`},{label:`Modelo de cortina: ${I.tipo}`},{label:`Ba\xEDnha de chumbo: ${I.tecido.startsWith("9")?"Inclu\xEDda":I.bainha?"Sim":"N\xE3o"}`}]},{label:`${I.tipo==="Ilh\xF3s"?"Var\xE3o":"Calha"}`,price:le,subItems:[{label:`${I.tipo==="Ilh\xF3s"?"Modelo de var\xE3o":"Modelo de calha"}: ${I.calha}`},{label:`${I.tipo==="Ilh\xF3s"?"Suporte de var\xE3o":"Suporte da calha"}: ${I.tipo==="Ilh\xF3s"?"Parede":I.suporte}`}]},{label:"Instala\xE7\xE3o",price:ge,subItems:[]}]),I.inicio==="Estore"&&(o.drawText(`Janela ${N+1} -`,{x:c,y:a,size:8,font:C}),o.drawText(` ${I.medidas} CM`,{x:c+C.widthOfTextAtSize(`Janela ${N+1} -`,8),y:a,size:8,font:v}),a-=l,w=[{label:"Estore",price:re,subItems:[{label:`Modelo de estore: ${I.tecido}`}]},{label:"Instala\xE7\xE3o",price:ge,subItems:[]}]),I.inicio==="Estore Japon\xEAs"&&(o.drawText(`Janela ${N+1} -`,{x:c,y:a,size:8,font:C}),o.drawText(` ${I.medidas} CM`,{x:c+C.widthOfTextAtSize(`Janela ${N+1} -`,8),y:a,size:8,font:v}),a-=l,w=[{label:"Estore Japon\xEAs",price:re+le,subItems:[{label:`Modelo de estore: ${I.tecido}`}]},{label:"Instala\xE7\xE3o",price:ge,subItems:[]}]),w.forEach(Pe=>{o.drawText(`  - ${Pe.label}`,{x:c,y:a,size:8,font:C}),o.drawText(`${Pe.price.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:v}),a-=l,Pe.subItems.forEach(qa=>{o.drawText(`      \u2022 ${qa.label}`,{x:c+20,y:a,size:8,font:v}),a-=l}),a-=l}),o.drawText("Total",{x:c,y:a,size:8,font:C}),o.drawText(`${Le.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontReg:v}),a-=l,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l}),a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=Y-l*2,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:C}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:C}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l);let Va=f[0].correcao?"Sim":"Facultadas pelo cliente";o.drawText("Retifica\xE7\xE3o de medidas:",{x:c,y:a,size:8,font:C}),o.drawText(Va,{x:c+C.widthOfTextAtSize("Retifica\xE7\xE3o de medidas:",8)+2,y:a,size:8,font:v});let xt=f[0].correcao?30:0;F+=xt,o.drawText(`${xt.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:v}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l*2,a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=Y-l*2,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:C}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:C}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l),o.drawText("Total:",{x:d-150,y:a,size:10,font:C}),o.drawText(`${F.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontBold:C}),a<108+E&&(o=s.addPage([595.28,841.89]),a=800,a=Y-l*2,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:C}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:C}),a-=l-4,a-=p,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=p+l),a-=l*4,o.drawText("Observa\xE7\xF5es:",{x:c,y:a,size:10,font:C});let fe="\u2022 ",ye=10;o.drawText(`${fe}Valores com IVA incluido \xE0 taxa em vigor. Or\xE7amento v\xE1lido por 15 dias.`,{x:c+ye,y:a-l,size:8,font:v}),o.drawText(`${fe}Calhas j\xE1 incluem os rod\xEDzios e suportes necess\xE1rios para as medidas selecionadas.`,{x:c+ye,y:a-2*l,size:8,font:v}),o.drawText(`${fe}Valor referente \xE0 instala\xE7\xE3o e rectifica\xE7\xE3o de medidas sujeito a valida\xE7\xE3o do c\xF3digo postal.`,{x:c+ye,y:a-3*l,size:8,font:v}),o.drawText(`${fe}Valor da Rectifica\xE7\xE3o de Medidas \xE9 deduzido do or\xE7amento na adjudica\xE7\xE3o do mesmo.`,{x:c+ye,y:a-4*l,size:8,font:v}),o.drawText(`${fe}IBAN: PT50 0007 0000 0041 4543 3722 3`,{x:c+ye,y:a-5*l,size:8,font:v}),aa(E,l,d,t,c,s,v);let Ja=await s.save(),bt=new Blob([Ja],{type:"application/pdf"}),qe=document.createElement("a");return qe.href=URL.createObjectURL(bt),qe.download="Orcamento_Fabric-Store.pdf",{blob:bt,pdfDoc:s,link:qe}},rt=async()=>{let e=0,t="";t+=`Data: ${new Date().toLocaleDateString()}

`,t+=`Cliente: ${n.nome}

`,t+=`Email: ${n.email}

`;let s=f[0].correcao?"  Sim:":"  Facultadas pelo cliente:",o=f[0].correcao?30:0;return f.forEach((c,d)=>{let{usedWidth:l,tecido:p,calha:F,instalacao:E,total:v}=ut(c);e+=v,c.inicio==="Cortina"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Cortinado: ${p.toFixed(2)}\u20AC
`,t+=`    Tipo de tecido: ${c.tecido}
`,t+=`    Modelo de Cortina: ${c.tipo}
`,t+=`    Ba\xEDnha de chumbo: ${c.tecido.startsWith("9")?"Inclu\xEDda":c.bainha?"Sim":"N\xE3o"}

`,t+=`  Calha: ${F.toFixed(2)}\u20AC
`,t+=`    Modelo de calha: ${c.tipo}
`,t+=`    Suporte da calha: ${c.suporte}

`),c.inicio==="Estore"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Estore: ${p.toFixed(2)}\u20AC
`,t+=`    Modelo de estore: ${c.tecido}

`),c.inicio==="Estore Japon\xEAs"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Estore: ${parseFloat(p.toFixed(2))+parseFloat(F.toFixed(2))}\u20AC
`,t+=`    Modelo de estore: ${c.tecido}

`),c.inicio==="Toalha"&&(t+=`Toalha ${d+1} - ${c.medidas} CM: ${v.toFixed(2)}\u20AC

`,t+=`  Toalha: ${p.toFixed(2)}\u20AC
`,t+=`    Tecido: ${c.tecido}
`,t+=`    Forma: ${c.forma}
`,t+=`    Largura: ${c.medidas.split(" X ")[0]}cm
`,t+=`    Altura: ${c.medidas.split(" X ")[1]}cm
`,t+=`    Margem: ${c.medidas.split(" X ")[2]}cm
`),t+=`  Instala\xE7\xE3o: ${E.toFixed(2)}\u20AC

`}),t+=`Retifica\xE7\xE3o de medidas:
${s} ${o.toFixed(2)}\u20AC

`,e+=o,t+=`Total: ${e.toFixed(2)}\u20AC

`,new Blob([t],{type:"text/plain"})},oa=e=>new Promise((t,s)=>{let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{let a=document.createElement("canvas");a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0);let d=a.toDataURL("image/png");t(d)},o.onerror=a=>{s(new Error(`Failed to load image from ${e}: ${a.message}`))}}),Q=e=>{e||(Ee.style.display="none",xe.style.display="none",be.style.display="none"),e==="Cortina"&&(Ee.style.display="flex",xe.style.display="none",be.style.display="none"),e==="Estore"&&(Ee.style.display="none",xe.style.display="flex",be.style.display="none"),e==="Toalha"&&(Ee.style.display="none",xe.style.display="none",be.style.display="flex")},sa=()=>{gsap.registerPlugin(ScrollToPlugin),gsap.to(window,{duration:1,scrollTo:{y:0},ease:"power2.inOut"})},i=(e,t)=>{t?gsap.fromTo(e,{opacity:0},{opacity:1,duration:.8,delay:.2,ease:"power2.inOut",onStart:()=>{e.style.display="flex"}}):gsap.to(e,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>{e.style.display="none",sa()}})},lt=()=>{Object.keys(h).forEach(e=>{h[e].classList.remove("active"),h[e].classList.add("next"),h[e].classList.remove("done"),h[e].getElementsByClassName("step_number")[0].classList.remove("active"),h[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},L=e=>{h[e].classList.remove("active"),h[e].classList.remove("next"),h[e].classList.add("done"),h[e].getElementsByClassName("step_number")[0].classList.remove("active"),h[e].getElementsByClassName("step_description")[0].classList.contains("next")&&h[e].getElementsByClassName("step_description")[0].classList.remove("next"),h[e].getElementsByClassName("step_description")[0].textContent=n[e],e==="instala\xE7\xE3o"&&(h.instalacaoEstore?.classList.remove("active"),h.instalacaoEstore?.classList.remove("next"),h.instalacaoEstore?.classList.add("done"),h.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),h.instalacaoEstore.getElementsByClassName("step_description")[0].textContent=n.instalacao?"c/Instala\xE7\xE3o":"s/Instala\xE7\xE3o"),e==="medidas"&&(f.length>0?h[e].getElementsByClassName("step_description")[0].innerHTML+=f[0].correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o":h[e].getElementsByClassName("step_description")[0].innerHTML+=n.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o",h.medidasEstore?.classList.remove("active"),h.medidasEstore?.classList.remove("next"),h.medidasEstore?.classList.add("done"),h.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),h.medidasEstore.getElementsByClassName("step_description")[0].textContent=`${x?.value} X ${$?.value}cm`,h.medidasEstore.getElementsByClassName("step_description")[0].innerHTML+=`${n.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o"}`),e==="medidasToalha"&&(h.medidasToalha?.classList.remove("active"),h.medidasToalha?.classList.remove("next"),h.medidasToalha?.classList.add("done"),h.medidasToalha?.getElementsByClassName("step_number")[0].classList.remove("active"),n.forma==="Redonda"||n.forma==="Quadrada"?h.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${x?.value} X ${x?.value} X ${z?.value} cm`:h.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${x?.value} X ${$?.value} X ${z?.value} cm`),e==="tipo"&&(h[e].getElementsByClassName("step_description")[0].innerHTML+=`${n.bainha?"<br>c/Ba\xEDnha de Chumbo":"<br>s/Ba\xEDnha de Chumbo"}`)},S=e=>{let t=e==="toalhaProduto"?"tecido":e;h[t].classList.remove("next"),h[t].classList.add("active"),h[t].getElementsByClassName("step_number")[0].classList.add("active"),t==="instalacao"&&(h.instalacaoEstore?.classList.remove("next"),h.instalacaoEstore?.classList.add("active"),h.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.add("active")),t==="medidas"&&(h.medidasEstore?.classList.remove("next"),h.medidasEstore?.classList.add("active"),h.medidasEstore?.getElementsByClassName("step_number")[0].classList.add("active"))},ia=e=>{let t=e;if(t==="suporte"&&(t="calha"),h[t].classList.contains("active")&&(h[t].classList.remove("active"),h[t].getElementsByClassName("step_number")[0].classList.remove("active")),t==="instalacao"&&(h.instalacaoEstore?.classList.remove("active"),h.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),t==="medidas"&&(h.medidasEstore?.classList.remove("active"),h.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),!T||k())return L(t);h[t].classList.add("next"),h[t].querySelector("step_description")&&!h[t].querySelector("step_description")[0].classList.contains("next")&&h[t].querySelector("step_description")[0].classList.add("next"),t==="instalacao"&&h.instalacaoEstore?.classList.add("next"),t==="medidas"&&h.medidasEstore?.classList.add("next")},m=e=>{e&&he?.classList.contains("inactive")&&he.classList.remove("inactive"),e||he?.classList.contains("inactive")||he.classList.add("inactive")},Ne=e=>{e.classList.add("active")},Re=e=>{e.classList.remove("active")},G=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),s.classList.add("active")},X=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),s.classList.remove("active")},Ka=e=>{e.classList.add("show"),gsap.fromTo(e,{opacity:0},{opacity:1,duration:1,ease:"power1.in"})},Za=e=>{e.classList.add("show"),gsap.fromTo(e,{x:-100,opacity:0},{x:0,opacity:1,duration:1,ease:"power1.inOut"})},Ya=(e,t=0)=>{gsap.fromTo(e.map(s=>`#${s}`),{opacity:0,x:-300},{opacity:1,x:0,duration:1,ease:"power1.inOut",stagger:t})},na=e=>{e==="Toalha"?(je.style.display="flex",Ue.style.display="none"):(je.style.display="none",Ue.style.display="block")},ca=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.getElementsByTagName("h1")[0].textContent;G(t),e.forEach(o=>{o!==t&&X(o)}),W(s),na(s),B(r.inicio,s),k()&&m(!0)})})},ra=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(s=>{s.addEventListener("click",()=>{let o=at(s),a=jt(s),c=We.find(l=>l.product===o),d=s.getElementsByClassName("tecido_color");if(t.forEach(l=>Re(l)),G(s,r.tecido),e.forEach(l=>{l!==s&&X(l)}),c){for(let l=0;l<d.length;l++)d.item(l).id===`${c.color}`&&Ne(d.item(l));y==="tecido"&&B(r.tecido,c.color),y==="calha"&&Me(c.color)}else d.length>0&&Ne(d[0]),y==="tecido"&&a!==""&&B(r.tecido,`${a}`),y==="calha"&&a!==""&&Me(a);k()&&m(!0)})})},la=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",s=>{let o=s.currentTarget,a=o&&o.id;Ne(o),e.forEach(p=>{p!==o&&Re(p)});let c=a?a.split("-")[0]:"",d=We.find(p=>p.product===c);d?d.color=`${a}`:We.push({product:c,color:`${a}`});let l=o.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let p=0;p<e.length;p++)if(e[p].getAttribute("id")===a){let F=e[p].querySelector(".source");F?l.setAttribute("src",F.getAttribute("src")):l.setAttribute("src",e[p].getElementsByTagName("img")[0].getAttribute("src")),l.setAttribute("srcset","");break}return y==="calha"&&a!==""?Me(a):y==="tecido"&&a!==""?B(r.tecido,a):console.log("No color was stored")})})},da=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t,r.tipo),e.forEach(s=>{s!==t&&X(s)}),B(r.tipo,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ua=()=>{let e=document.querySelectorAll("[id^='forma-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t),e.forEach(s=>{s!==t&&X(s)}),B(r.forma,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ma=()=>{let e=document.querySelectorAll("[id^='bainha-card']");e.forEach(t=>{t.addEventListener("click",()=>{G(t),e.forEach(s=>{s!==t&&X(s)}),B(r.bainha,t.getElementsByTagName("h1")[0].textContent),k()&&m(!0)})})},ha=()=>{Te.addEventListener("change",function(e){B(r.bainha,Te.checked)})},pa=()=>{R?.addEventListener("change",e=>{(R?.checked===!0||ue?.checked===!0)&&(tt("Parede"),k()&&m(!0))}),ue?.addEventListener("change",e=>{(R?.checked===!0||ue?.checked===!0)&&(tt("Tecto"),k()&&m(!0))})},fa=()=>{z?.addEventListener("input",e=>{if(n.inicio==="Toalha"){if(n.forma==="Quadrada"||n.forma==="Redonda"){if(x?.value===""||z?.value===""){m(!1);return}}else if(x?.value===""||$?.value===""||z?.value===""){m(!1);return}}else if(x?.value===""||$?.value===""){m(!1);return}k()&&B(r.medidas,`${x?.value} X ${$?.value}`),x?.value!==""&&$?.value!==""&&(k()?m(!0):m(!1))}),x?.addEventListener("input",e=>{if(n.inicio==="Toalha"){if(n.forma==="Quadrada"||n.forma==="Redonda"){if(x?.value===""||z?.value===""){m(!1);return}}else if(x?.value===""||$?.value===""||z?.value===""){m(!1);return}}else if(x?.value===""||$?.value===""){m(!1);return}k()&&B(r.medidas,`${x?.value} X ${$?.value}`),x?.value!==""&&$?.value!==""&&(k()?m(!0):m(!1))}),$?.addEventListener("input",e=>{if(n.inicio==="Toalha"){if(x?.value===""||$?.value===""||z?.value===""){m(!1);return}}else if(x?.value===""||$?.value===""){m(!1);return}k()&&B(r.medidas,`${x?.value} X ${$?.value}`),x?.value!==""&&$?.value!==""&&(k()?m(!0):m(!1))})},ya=()=>{de.addEventListener("change",function(e){B(r.correcao,de.checked)})},ga=()=>{me.addEventListener("change",function(e){B(r.instalacao,me.checked)})},Ea=()=>{Object.keys(h).forEach(e=>{h[e].addEventListener("click",()=>{Yt(e)})})},xa=()=>{Object.keys(P).forEach(e=>{P[e].addEventListener("click",()=>{e==="correcao"||e==="estoreCorrecao"||e!=="suporte"&&e!=="bainha"&&nt(e)})})},dt=e=>{e.button.addEventListener("click",()=>{it(e)})},ba=()=>{Pt.addEventListener("click",async()=>{n.nome=se.value,n.email=ie.value,n.contacto=Ke.checked;let e=await rt(),{blob:t,pdfDoc:s,link:o}=await ct();V.push({blob:t,pdf:s,link:o}),V[V.length-1].link.click()})},Ca=()=>{Lt.addEventListener("click",async()=>{n.nome=se.value,n.email=ie.value,n.contacto=Ke.checked;let{blob:e,pdfDoc:t,link:s}=await ct();V.push({blob:e,pdf:t,link:s});let o=await rt();await Da(n.nome,n.email,n.contacto?"Aceita":"N\xE3o aceita",V[V.length-1].blob,o,V[V.length-1].link)})},va=()=>{Tt.addEventListener("click",Vt)},Ba=()=>{$t.addEventListener("click",()=>{It.style.display="none",kt.style.display="flex"})},Ia=()=>{he.addEventListener("click",wt)},ka=e=>{if(e.inicio==="Toalha"){let s=e.medidas.split(" X "),[o,a,c]=s.map(F=>parseInt(F)),d=Math.max(o,a),l=Math.min(o,a),p=e.bainha.includes("Cantos")?g.bainhaToalhas.cantos.widthMargin:g.bainhaToalhas.normal.widthMargin;return d+2*c+p<=g.maxWidthToalhas?l+2*c+p:d+2*c+p}if(e.inicio==="Estore Japon\xEAs")return e.medidas?parseInt(e.medidas.split(" X ")[0]):0;let t=g.usedWidths.find(s=>e.tipo===s.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+g.bainhaPrice.widthMargin:0},Ta=(e,t)=>{let s=e.medidas.split(" X ")[0],o=0,a=0,c=Dt(e);return e.inicio==="Toalha"&&(o=c.product*(t/100)),e.inicio==="Cortina"&&(o=c.product*(t/100),a=c.calha),e.inicio==="Estore"&&(o=c.product),e.inicio==="Estore Japon\xEAs"&&(o=c.product*((t+g.bainhaEstoreJaponesPrice.widthMargin)/100),a=c.calha),{product:o,calha:a}},$a=(e,t)=>{if(e.inicio==="Toalha"){let o=e.forma==="Redonda"?"circle":e.forma==="Quadrada"?"square":"retangle",a=e.bainha.includes("Cantos")?"cantos":"normal",c=g.manufacturingPrices.towels[o][a].find(d=>t<=d.maxWidth);return c?c.price:0}if(e.inicio==="Estore")return 0;if(e.inicio==="Estore Japon\xEAs"){let o=e.medidas.split(" X ")[0],a=e.medidas.split(" X ")[1],c=parseInt(o)/100*(parseInt(a)/100);return c?c*g.manufacturingPrices.japaneseBlind:0}let s=g.manufacturingPrices.curtains.find(o=>e.tipo===o.name);return s?e.tecido.startsWith("8")?s.blackout*(t/100):e.tecido.startsWith("9")&&(e.tipo==="Ondas"||e.tipo==="Franzido")?s.alinhado*(t/100):s.normal*(t/100):0},La=(e,t)=>e.inicio==="Toalha"||e.inicio==="Cortina"&&e.tecido.startsWith("9")||e.inicio.startsWith("Estore")?0:e.bainha?g.bainhaPrice.price*(t/100):0,wa=e=>e.inicio==="Toalha"?0:e.correcao?g.measuresCheckPrice:0,Pa=e=>{if(e.inicio==="Toalha"||!f[0].instalacao)return 0;let t=0,s=parseInt(e.medidas.split(" X ")[0]),o=g.instalation.find(a=>s<=a.maxWidth);return o&&(t=o.price),o&&e.inicio==="Cortina"&&e.calha.startsWith("9500")&&(t*=2),t||0},ut=e=>{let t=ka(e),s=Ta(e,t),o=$a(e,t),a=La(e,t),c=Pa(e),d=s.product+o+a+s.calha+c;return e.totalPrice=d,{usedWidth:t,tecido:s.product+o+a,calha:s.calha,instalacao:c,total:d}},Wa=e=>{let t=e.indexOf("@");return t>0&&t<e.length-1},Ve=e=>new Promise((t,s)=>{let o=new FileReader;o.onloadend=()=>t(o.result),o.onerror=s,o.readAsDataURL(e)}),Sa=()=>se.value.trim()===""?(ne.textContent="Preencher este campo obrigat\xF3rio",ne.classList.add("u-text-main"),!0):(ne.textContent="",ne.classList.remove("u-text-main"),!1),Fa=()=>{let e=ie.value.trim();return e===""?(U.textContent="Preencher este campo obrigat\xF3rio",U.classList.add("u-text-main"),!0):Wa(e)?(U.textContent="",U.classList.remove("u-text-main"),!1):(U.textContent="Insira um email v\xE1lido",U.classList.add("u-text-main"),!0)},Je=()=>{Aa();let e=Sa(),t=Fa();za(e||t),Ma(e||t)},Oa=()=>{se?.addEventListener("input",Je),ie?.addEventListener("input",Je)},Aa=()=>{ne.textContent="",U.textContent="",et.textContent="",ne.classList.remove("u-text-main"),U.classList.remove("u-text-main"),et.classList.remove("u-text-main")},za=e=>{e&&Ye?.classList.add("inactive"),e||Ye?.classList.remove("inactive")},Ma=e=>{e&&we?.classList.add("inactive"),e||we?.classList.remove("inactive")},eo=async e=>{let t=null;try{let o=await e;t=await Ve(o)}catch{console.error("Failed to load txt"),t=null}let s={name:n.nome,email:n.email,check:n.contacto?"Aceita":"N\xE3o aceita",file:t,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_txt",s).then(function(o){console.log("TXT DL SUCCESS!",o.status,o.text)},function(o){console.log("TXT DL FAILED...",o)})},Da=async(e,t,s,o,a,c)=>{let d=null,l=null;try{let E=await o,v=await a;d=await Ve(E),l=await Ve(v)}catch{console.error("Failed to load PDF"),d=null}let p={name:e,email:t,check:s,file:d,to_company_email:"contact@fabricstore.pt",to_user_email:t,reply_to:"contact@fabricstore.pt"},F={name:e,email:t,check:s,file:l,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_pdf",p).then(function(E){console.log("PDF EMAIL SUCCESS!",E.status,E.text),Bt.style.display="none",Ae.style.display="none",ze.textContent="Obrigado pelo seu contacto!",ze.style.display="block"},function(E){console.log("PDF EMAIL FAILED...",E),ze.style.display="none",Ae.textContent="Aconteceu um erro durante o envio. Tente novamente ou entre em contacto connosco.",Ae.style.display="block"}),emailjs.send("service_fabricstore","template_quote_txt",F).then(function(E){console.log("TXT SUCCESS!",E.status,E.text)},function(E){console.log("TXT FAILED...",E)})},mt={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},ht=new Swiper(".swiper",mt),to=()=>{ht.destroy(),ht=new Swiper(".swiper",mt)},ao=()=>{let e=125;for(let t=0;t<5;t++)e=125+t*125,f.push({inicio:"Cortina",tecido:"101015-003",tipo:"Ondas",medidas:`${e} X 250`,correcao:t%2!==0,calha:"5000-Branco",instalacao:t%2===0})},oo=()=>{f.push({inicio:"Cortina",tecido:"120100-008",tipo:"Franzido",medidas:"200 X 250",correcao:!0,calha:"5000-B",instalacao:!0})},so=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];ie.value="ritabreu@test.pt",se.value="Rita Abreu",f.push(...e)},io=()=>{let e=[{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"348 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];ie.value="ritabreu@test.pt",se.value="Rita Abreu",f.push(...e)},no=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"360 X 150",correcao:!1,calha:"5000-B",instalacao:!1}];f.push(...e)},co=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"350 X 240",correcao:!0,calha:"5000-B",instalacao:!0}];f.push(...e)};Mt()});})();
