"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let Ke="orcamento-interno",At="https://cdn.prod.website-files.com/66aadbd497db3d8c63799460/66f69f0aaa45e095bd2e0f3f_LOGOTIPO%20FABRICSTORE_color%201.png",O={},mo={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},M={estoresJaponeses:{width:[80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400]},estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"VARAO-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},Ae=[],q=[],g=[],N=0,p="inicio",i={inicio:"",tecido:"",tipo:"",bainha:"",forma:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:"",loja:"",vendedor:""},y={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:{japaneseBlind:20,curtains:[{name:"Franzido",blackout:9,normal:8,alinhado:8},{name:"Ondas",blackout:8.5,normal:7.5,alinhado:7.5},{name:"Macho Juntos",normal:12.5,blackout:13.5,alinhado:12.5},{name:"Pregas",normal:12.5,blackout:13.5,alinhado:12.5}],towels:{circle:{normal:[{maxWidth:200,price:8},{maxWidth:280,price:10}]},square:{normal:[{maxWidth:150,price:5},{maxWidth:200,price:6},{maxWidth:250,price:8},{maxWidth:280,price:9}],cantos:[{maxWidth:150,price:6.5},{maxWidth:200,price:8},{maxWidth:250,price:10},{maxWidth:280,price:14}]},retangle:{normal:[{maxWidth:280,price:5},{maxWidth:400,price:7},{maxWidth:500,price:8.5}],cantos:[{maxWidth:280,price:8},{maxWidth:400,price:12.5},{maxWidth:500,price:14.5},{maxWidth:600,price:16.5}]}}},bainhaPrice:{price:3.5,widthMargin:20},bainhaEstoreJaponesPrice:{price:3.5,widthMargin:30},uniao:{maxLength:400,price:8.6,calha9500M:15},prolongadores:3.7,roletesPrice:5,bainhaToalhas:{normal:{price:3.5,widthMargin:10},cantos:{price:5,widthMargin:15}},maxWidthToalhasNoPriceIncrease:170,minWidthToalhas:0,maxWidthToalhas:280,minLengthToalhas:0,maxLengthToalhas:4e3,minTowelMargin:0,maxTowelMargin:75,minWindowWidthEstores:80,maxWindowWidthEstores:300,minWindowHeightEstores:80,maxWindowHeightEstores:300,maxWindowWidth:650,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},k=!0,Ze=document.getElementById("sim-container"),Ee=document.getElementById("steps-cortina"),be=document.getElementById("steps-estore"),ve=document.getElementById("steps-toalha"),u={step1:document.getElementById("simulator-heading-1"),step1i:document.getElementById("inicio-description"),step1c:document.getElementById("inicio-description-c"),step1e:document.getElementById("inicio-description-e"),step2:document.getElementById("simulator-heading-2"),step2t:document.getElementById("tipo-description"),step2b:document.getElementById("bainha-description"),step2toalha:document.getElementById("simulator-heading-2-toalha"),step2f:document.getElementById("forma-description"),step2bt:document.getElementById("bainha-toalha-description"),step3:document.getElementById("simulator-heading-3"),step3m:document.getElementById("medidas-description"),step3c:document.getElementById("correcao-description"),step4:document.getElementById("simulator-heading-4"),step4c:document.getElementById("calha-description"),step4s:document.getElementById("suporte-description"),step5:document.getElementById("simulator-heading-5"),step5i:document.getElementById("instalacao-description")},l={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),forma:document.getElementById("forma-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},Ce=document.getElementById("largura-input-descr-c"),Ie=document.getElementById("altura-input-descr-c"),Be=document.getElementById("largura-input-descr-e"),Te=document.getElementById("altura-input-descr-e"),v=document.getElementById("largura-input"),L=document.getElementById("altura-input"),_=document.getElementById("margem-input"),te=document.getElementById("largura-contain"),ae=document.getElementById("altura-contain"),ke=document.getElementById("margem-contain"),re=document.querySelector("#correcao-switch"),Le=document.querySelector("#bainha"),de=document.getElementById("tecto-radio-btn"),X=document.getElementById("parede-radio-btn"),ue=document.querySelector("#instalacao-switch"),Ye=document.getElementById("bainha-toalha"),we=document.getElementById("bainha-form"),j=document.getElementById("largura-min-error-estore"),J=document.getElementById("altura-min-error-estore"),H=document.getElementById("largura-max-error-estore"),U=document.getElementById("altura-max-error-estore"),et=document.getElementById("margem-min-error"),tt=document.getElementById("margem-max-error"),oe=document.getElementById("largura-error"),se=document.getElementById("altura-error"),me=document.getElementById("seguinte-btn"),f={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao"),medidasEstore:document.getElementById("step-medidas-estore"),instalacaoEstore:document.getElementById("step-instalacao-estore"),medidasToalha:document.getElementById("step-medidas-toalha"),forma:document.getElementById("step-forma-toalha")},Mt=document.getElementById("form"),$e=document.getElementById("nome-input"),We=document.getElementById("email-input"),at=document.getElementById("contacto-switch"),_t=document.querySelector(".vendedores_data"),Pe=document.querySelector(".lojas_select"),he=document.querySelector(".vendedores_select"),ot=document.getElementById("checkout-container"),Ot=document.getElementById("new-window-contain"),Nt=document.getElementById("checkout-input-contain"),Me=document.getElementById("checkout-info-estore"),_e=document.getElementById("checkout-info-cortina"),Oe=document.getElementById("checkout-info-toalha"),Dt=document.getElementById("new-window-btn"),Vt=document.getElementById("no-window-btn"),Xt=document.getElementById("enviar-btn"),Rt=document.getElementById("download-btn"),st=document.getElementById("enviar-btn-contain"),it=document.getElementById("download-btn-contain"),W={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao"),estoreProduto:document.getElementById("checkout-produto-estore"),estoreLargura:document.getElementById("checkout-largura-estore"),estoreAltura:document.getElementById("checkout-altura-estore"),estoreCorrecao:document.getElementById("checkout-correcao-estore"),estoreInstalacao:document.getElementById("checkout-instalacao-estore"),toalhaProduto:document.getElementById("checkout-produto-toalha"),toalhaForma:document.getElementById("checkout-forma-toalha"),toalhaBainha:document.getElementById("checkout-bainha-toalha"),toalhaLargura:document.getElementById("checkout-largura-toalha"),toalhaAltura:document.getElementById("checkout-altura-toalha"),toalhaMargem:document.getElementById("checkout-margem-toalha")},Ne=document.getElementById("feedback-div"),De=document.getElementById("feedback-success"),ie=document.getElementById("name-error"),Q=document.getElementById("email-error"),nt=document.getElementById("contacto-switch-error"),qt=document.getElementById("cortina-radio-btn"),jt=document.getElementById("estore-radio-btn"),Jt=document.getElementById("calha-radio-btn"),Ht=document.getElementById("varao-radio-btn"),Ut=document.getElementById("toalha-radio-btn"),ho=document.getElementById("clear-all-btn"),fe=document.getElementById("clear-all-txt"),Qt=()=>{Na(),va(),Ca(),Ba(),Ta(),ka(),La(),Pa(),Sa(),Ia(),Ma(),Aa(),_a(),Oa(),za(),Fa(),Wa(),$a(),Qa(),Da()},Gt=()=>{Zt(),Qt(),Ue()},Kt=e=>{let t=0,s=0,o="",a=e.tecido.split("-"),c=a[0],d=a[1],r=e.calha?e.calha.split("-"):null,h=r?r[0]:null,P=r?r[1]:null,E=e.medidas?e.medidas.split(" X ")[0]:0;if((e.inicio==="Cortina"||e.inicio==="Estore Japon\xEAs"||e.inicio==="Toalha")&&(o=`${c}${d}`),e.inicio==="Estore"){let z=e.medidas?e.medidas.split(" X ")[1]:0;o=aa(c,d,E,z)}if(t=typeof O[o].price=="string"?parseFloat(O[o].price):O[o].price,e.inicio==="Toalha")return{product:t,calha:0};if(e.inicio==="Estore")return{product:t,calha:0};if(e.inicio==="Estore Japon\xEAs"){let z=oa(E),w=O[z]?typeof O[z].price=="string"?parseFloat(O[z].price):O[z].price:0;return{product:t,calha:w}}let b=(E/y.maxCalhaWidth|0)+1,x=E<=y.maxCalhaWidth?E:E/b,A=sa(h,e.tipo,P,x,e?.suporte==="Parede");return s=O[A]?E<y.maxCalhaWidth?O[A].price:O[A].price*b:0,s+=E>y.maxCalhaWidth?y.prolongadores*b:E>y.uniao.maxLength&&e.calha.startsWith("9500M")?y.uniao.calha9500M*b:E>y.uniao.maxLength?y.uniao.price*b:0,(A.startsWith("5000")||A.startsWith("1500"))&&(s+=E<y.maxCalhaWidth?y.roletesPrice:y.roletesPrice*b),{product:t,calha:s}},Zt=()=>{fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRnpR16s-LlJCttzFQBqDmgLYSIGtTKbBKbDGUXfvjwGHR2W3u66qn4TV8DkHr2280Oru6V4QVgFYJV/pub?output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),s=t[0].split(","),o=t.slice(1).map(c=>c.split(",")),a={};o.forEach(c=>{let[d,r]=c;a[d]||(a[d]={id:d,price:parseFloat(r)})}),O=a}).catch(e=>console.error("Error fetching CSV data:",e))},I=(e,t)=>{i[e.id.split("-")[0]]=t},Ve=e=>{i.calha=e},ct=e=>{i.suporte=X.checked?"Parede":"Tecto"},Yt=()=>{i.inicio="",i.tecido="",i.tipo="",i.bainha="",i.medidas="",i.correcao="",i.calha="",i.suporte="",i.instalacao=""},wt=e=>{e.inicio==="Cortina"&&(I(l.inicio,e.inicio),I(l.tecido,e.tecido),I(l.tipo,e.tipo),I(l.bainha,e.bainha),I(l.medidas,e.medidas),I(l.correcao,e.correcao),I(l.suporte,e.suporte),I(l.instalacao,e.instalacao)),e.inicio.startsWith("Estore")&&(I(l.inicio,e.inicio),I(l.tecido,e.tecido),I(l.medidas,e.medidas),I(l.correcao,e.correcao),I(l.instalacao,e.instalacao))},ea=()=>{k||(g[N].inicio=i.inicio,g[N].bainha=i.bainha,g[N].tecido=i.tecido,g[N].tipo=i.tipo,g[N].medidas=i.medidas,g[N].correcao=i.correcao,g[N].calha=i.calha,g[N].suporte=i.suporte,g[N].instalacao=i.instalacao)},ne=()=>{let e={index:g.length,inicio:i.inicio,bainha:i.bainha,forma:i.forma,tecido:i.tecido,tipo:i.tipo,medidas:i.medidas,correcao:i.correcao,calha:i.calha,suporte:i.suporte,instalacao:i.instalacao};g.push(e),k=!1},ta=()=>{S("Cortina"),Yt(),ca(),pt(),N=g.length,mt("inicio"),k=!0},T=()=>{switch(p){case"inicio":return i.inicio===""?(m(!1),!1):(m(!0),!0);case"tecido":return i.tecido===""?(m(!1),!1):(m(!0),!0);case"tipo":return i.tipo===""?(m(!1),!1):(m(!0),!0);case"forma":return i.forma===""?(m(!1),!1):(m(!0),!0);case"medidas":if(i.inicio==="Toalha"){if(parseInt(v?.value)+parseInt(_?.value)>y.maxWidthToalhas)return tt.style.display="block",m(!1),!1;if(parseInt(v?.value)+parseInt(_?.value)<y.minWidthToalhas)return et.style.display="block",m(!1),!1}return i.inicio==="Cortina"?parseInt(v?.value)>y.maxWindowWidth||parseInt(L?.value)>y.maxWindowHeight?(parseInt(v?.value)>y.maxWindowWidth?oe.style.display="block":oe.style.display="none",parseInt(L?.value)>y.maxWindowHeight?se.style.display="block":se.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",j.style.display="none",J.style.display="none",H.style.display="none",U.style.display="none",m(!0),!0):i.inicio==="Estore"?parseInt(v?.value)<y.minWindowWidthEstores||parseInt(L?.value)<y.minWindowHeightEstores?(parseInt(v?.value)<y.minWindowWidthEstores?j.style.display="block":j.style.display="none",parseInt(L?.value)<y.minWindowHeightEstores?J.style.display="block":J.style.display="none",m(!1),!1):parseInt(v?.value)>y.maxWindowWidthEstores||parseInt(L?.value)>y.maxWindowHeightEstores?(j.style.display="none",J.style.display="none",parseInt(v?.value)>y.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt(L?.value)>y.maxWindowHeightEstores?U.style.display="block":U.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",j.style.display="none",J.style.display="none",H.style.display="none",U.style.display="none",m(!0),!0):i.inicio==="Estore Japon\xEAs"?parseInt(v?.value)>y.maxWindowWidthEstores||parseInt(L?.value)>y.maxWindowHeightEstores?(j.style.display="none",J.style.display="none",parseInt(v?.value)>y.maxWindowWidthEstores?H.style.display="block":H.style.display="none",parseInt(L?.value)>y.maxWindowHeightEstores?U.style.display="block":U.style.display="none",m(!1),!1):(oe.style.display="none",se.style.display="none",j.style.display="none",J.style.display="none",H.style.display="none",U.style.display="none",m(!0),!0):(oe.style.display="none",se.style.display="none",j.style.display="none",J.style.display="none",H.style.display="none",U.style.display="none",tt.style.display="none",et.style.display="none",m(!0),!0);case"calha":return i.calha===""?(m(!1),!1):(m(!0),!0);case"suporte":return i.suporte===""?(m(!1),!1):(m(!0),!0)}return m(!0),!0},aa=(e,t,s,o)=>{let a=M.estores.width.find(d=>d>=s),c=M.estores.height.find(d=>d>=o);return`${e}${c}${a}`},oa=e=>`ROMANETE${M.estoresJaponeses.width.find(s=>s>=e)}`,sa=(e,t,s,o,a)=>{if(t==="Ilh\xF3s"){let d=M.calhas[`${e}-${s}`]?.find(r=>r>=o);return`${e}${d}${s}`}if(e==="KS"){if(a){let r=M.calhas[e]?.find(h=>h>=o);return`${e}${t==="Franzido"?"F":"O"}${r}SP`}let d=M.calhas[e]?.find(r=>r>=o);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(a){let r=M.calhas[`${e}-${s}`]?.find(h=>h>=o);return`${e}${t==="Franzido"?"F":"O"}${r}${s}SP`}let d=M.calhas[`${e}-${s}`]?.find(r=>r>=o);return`${e}${t==="Franzido"?"F":"O"}${d}${s}`}if(e==="9500M"){if(a){let r=M.calhas[e].find(h=>h>=o);return`${e}${r}SP`}let d=M.calhas[e].find(r=>r>=o);return`${e}${d}`}if(a){let d=M.calhas[`${e}-${s}`].find(r=>r>=o);return`${e}${d}${s}SP`}let c=M.calhas[`${e}-${s}`].find(d=>d>=o);return`${e}${c}${s}`},ia=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},lt=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},na=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},S=e=>{e==="Toalha"&&(fe?.click(),setTimeout(()=>{Ut?.click()},300),pe()),e==="Estore"&&(fe?.click(),setTimeout(()=>{jt?.click()},300),pe()),(e==="Cortina"||e==="Estore Japon\xEAs")&&(fe?.click(),setTimeout(()=>{qt?.click()},300),pe()),e==="Calha"&&(fe?.click(),setTimeout(()=>{Jt?.click()},300),pe()),e==="Var\xE3o"&&(fe?.click(),setTimeout(()=>{Ht?.click()},300),pe())},ca=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),s=document.querySelectorAll("[id^='tecido-card']"),o=document.querySelectorAll(".tecido_color");e.forEach(a=>{D(a)}),t.forEach(a=>{D(a)}),s.forEach(a=>{D(a)}),o.forEach(a=>{Je(a)}),v.value="",L.value="",re.checked=!1,ue.checked=!1,X?.click(),Le.checked=!1},rt=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?K(s):D(s)})},Xe=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(s=>{lt(s).split("-")[0].startsWith(e.split("-")[0])?K(s):D(s)})},la=e=>{document.querySelectorAll("[id^='tipo-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?K(s):D(s)})},ra=e=>{e==="Parede"?X.click():de.click()},dt=()=>{de.checked=!1,X.checked=!1},Z=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(g.length===1&&(g[0].button=e,yt(g[0])),g.length>1&&e){let s=e.cloneNode(!0);s.querySelector(".checkout_info_title").textContent=`Janela ${g.length}`,g[g.length-1].button=s,yt(g[g.length-1]),t?.appendChild(s)}},da=e=>{e.inicio==="Cortina"&&(rt(e.inicio),Xe(e.tecido),la(e.tipo),Le.checked=e.bainha,v.value=e.medidas.split(" X ")[0],L.value=e.medidas.split(" X ")[1],re.checked=e.correcao,ra(e.suporte),ue.checked=e.instalacao),e.inicio.startsWith("Estore")&&(rt(e.inicio),Xe(e.tecido),v.value=e.medidas.split(" X ")[0],L.value=e.medidas.split(" X ")[1],re.checked=e.correcao,ue.checked=e.instalacao)},C=e=>{e==="inicio"&&(u.step1i.style.display="flex",u.step1c.style.display="none",u.step1e.style.display="none"),e==="tecido"&&i.inicio==="Cortina"&&(u.step1i.style.display="none",u.step1c.style.display="flex",u.step1e.style.display="none"),e==="tecido"&&i.inicio==="Estore"&&(u.step1i.style.display="none",u.step1c.style.display="none",u.step1e.style.display="flex"),e==="tipo"&&(u.step2t.style.display="flex",u.step2b.style.display="none"),e==="bainha"&&i.inicio==="Cortina"&&(u.step2t.style.display="none",u.step2b.style.display="flex"),e==="forma"&&(u.step2bt.style.display="none",u.step2f.style.display="flex"),e==="bainha"&&i.inicio==="Toalha"&&(u.step2bt.style.display="flex",u.step2f.style.display="none"),e==="medidas"&&(u.step3m.style.display="flex",u.step3c.style.display="none"),e==="correcao"&&(u.step3m.style.display="none",u.step3c.style.display="flex"),e==="calha"&&(u.step4c.style.display="flex",u.step4s.style.display="none"),e==="suporte"&&(u.step4c.style.display="none",u.step4s.style.display="flex"),e==="instalacao"&&(u.step5.style.display="flex")},ua=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e===p)return;let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||e==="medidasEstore"||i.inicio==="Estore")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura"||e==="medidasEstore")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),f[e].classList.contains("done")){switch(Ea(p),n(u[na(p)],!1),n(p==="calha"?l.tecido:l[p],!1),C(e),e){case"tecido":i.inicio==="Estore Japon\xEAs"?S("Cortina"):S(t?"Estore":"Cortina"),n(u.step1,!0),n(l.tecido,!0);break;case"tipo":n(u.step2,!0),n(l.tipo,!0);break;case"medidas":n(u.step3,!0),n(l.medidas,!0);break;case"calha":i.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),n(u.step4,!0),n(l.tecido,!0);break;case"instalacao":n(u.step5,!0),n(l.instalacao,!0);break}p=e,T(),F(e)}},Re=()=>{i.inicio==="Toalha"?(i.forma==="Quadrada"||i.forma==="Redonda"?(te&&(te.style.display="flex"),ae&&(ae.style.display="none")):(te&&(te.style.display="flex"),ae&&(ae.style.display="flex")),ke&&(ke.style.display="flex")):(te&&(te.style.display="flex"),ae&&(ae.style.display="flex"),ke&&(ke.style.display="none"))},qe=()=>{i.inicio==="Cortina"&&(Ce.style.display="block",Ie.style.display="block",Be.style.display="none",Te.style.display="none"),(i.inicio==="Estore"||i.inicio==="Estore Japon\xEAs")&&(Ce.style.display="none",Ie.style.display="none",Be.style.display="block",Te.style.display="block"),i.inicio==="Toalha"&&(i.forma==="Quadrada"||i.forma==="Redonda")?(Ce.style.display="none",Ie.style.display="none",Be.style.display="block",Te.style.display="none"):i.inicio==="Toalha"&&(Ce.style.display="none",Ie.style.display="none",Be.style.display="block",Te.style.display="block")},ma=()=>{if(i.inicio==="Cortina")switch(p){case"inicio":T()&&(S(i.inicio),G("Cortina"),n(l.inicio,!1),C("tecido"),k&&m(!1),n(l.tecido,!0),p="tecido");break;case"tecido":T()&&(C("tecido"),$("tecido"),F("tipo"),n(u.step1,!1),k&&m(!1),n(l.tecido,!1),C("tipo"),n(u.step2,!0),n(l.tipo,!0),qe(),Re(),p="tipo");break;case"tipo":T()&&(n(l.tipo,!1),i.tecido.startsWith("9")?(I(l.bainha,!0),k&&m(!1),$("tipo"),F("medidas"),n(u.step2,!1),C("medidas"),n(u.step3,!0),n(l.medidas,!0),p="medidas"):(C("bainha"),n(l.bainha,!0),p="bainha"));break;case"bainha":I(l.bainha,`${i.tecido.startsWith("9")?!0:i.bainha?i.bainha:!1}`),$("tipo"),F("medidas"),n(u.step2,!1),n(l.bainha,!1),k&&m(!1),C("medidas"),n(u.step3,!0),n(l.medidas,!0),p="medidas";break;case"medidas":T()&&(I(l.medidas,`${v?.value} X ${L?.value}`),n(l.medidas,!1),g.length>0?(k&&m(!1),i.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),n(u.step3,!1),C("calha"),n(u.step4,!0),n(l.tecido,!0),p="calha"):(C("correcao"),n(l.correcao,!0),p="correcao"));break;case"correcao":i.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),n(u.step3,!1),n(l.correcao,!1),k&&m(!1),C("calha"),n(u.step4,!0),n(l.tecido,!0),p="calha";break;case"calha":T()&&(n(l.tecido,!1),i.tipo==="Ilh\xF3s"?(m(!0),n(u.step4,!1),C("instalacao"),n(u.step5,!0),n(l.instalacao,!0),p="instalacao"):(k&&m(!1),dt(),C("suporte"),n(l.suporte,!0),p="suporte"));break;case"suporte":I(l.suporte,X?.checked?"Parede":"Tecto"),T()&&($("calha"),F("instalacao"),n(u.step4,!1),n(l.suporte,!1),C("instalacao"),g.length>0?(k&&(ne(),Z()),Y()):(n(u.step5,!0),n(l.instalacao,!0),p="instalacao"));break;case"instalacao":$("instalacao"),n(u.step5,!1),n(l.instalacao,!1),k&&(ne(),Z()),Y();break}else if(i.inicio==="Toalha")switch(p){case"inicio":T()&&(G("Toalha"),n(l.inicio,!1),C("tecido"),k&&m(!1),n(l.tecido,!0),p="tecido");break;case"tecido":T()&&(C("tecido"),$("tecido"),F("forma"),n(u.step1,!1),k&&m(!1),n(l.tecido,!1),C("forma"),n(u.step2toalha,!0),n(l.forma,!0),p="forma");break;case"forma":T()&&(n(l.forma,!1),qe(),Re(),k&&m(!1),i.forma==="Redonda"?(i.bainha="Ba\xEDnha Normal",$("forma"),F("medidas"),n(u.step2toalha,!1),n(u.step3,!0),n(l.medidas,!0),C("medidas"),p="medidas"):(n(l.bainha,!0),p="bainha"));break;case"bainha":$("forma"),F("medidas"),n(u.step2toalha,!1),n(l.bainha,!1),k&&m(!1),C("medidas"),n(u.step3,!0),n(l.medidas,!0),p="medidas";break;case"medidas":T()&&(i.inicio==="Toalha"&&(i.forma==="Quadrada"||i.forma==="Redonda")?I(l.medidas,`${v?.value} X ${v?.value} X ${_?.value}`):I(l.medidas,`${v?.value} X ${L?.value} X ${_?.value}`),n(l.medidas,!1),n(u.step3,!1),$("medidasToalha"),k&&(ne(),Z()),Y());break;case"correcao":i.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),$("medidas"),F("calha"),n(u.step3,!1),n(l.correcao,!1),k&&m(!1),C("calha"),n(u.step4,!0),n(l.tecido,!0),p="calha";break;case"calha":T()&&(n(l.tecido,!1),i.tipo==="Ilh\xF3s"?(m(!0),n(u.step4,!1),C("instalacao"),n(u.step5,!0),n(l.instalacao,!0),p="instalacao"):(k&&m(!1),dt(),C("suporte"),n(l.suporte,!0),p="suporte"));break;case"suporte":I(l.suporte,X?.checked?"Parede":"Tecto"),T()&&($("calha"),F("instalacao"),n(u.step4,!1),n(l.suporte,!1),C("instalacao"),g.length>0?(k&&(ne(),Z()),Y()):(n(u.step5,!0),n(l.instalacao,!0),p="instalacao"));break;case"instalacao":$("instalacao"),n(u.step5,!1),n(l.instalacao,!1),k&&(ne(),Z()),Y();break}else switch(p){case"inicio":T()&&(G("Estore"),n(l.inicio,!1),C("tecido"),k&&m(!1),n(l.tecido,!0),p="tecido");break;case"tecido":T()&&($("tecido"),F("medidas"),n(u.step1,!1),n(l.tecido,!1),qe(),Re(),k&&m(!1),C("medidas"),n(u.step3,!0),n(l.medidas,!0),p="medidas");break;case"medidas":T()&&(n(l.medidas,!1),g.length>0?($("medidas"),F("instalacao"),n(u.step3,!1),C("instalacao"),n(u.step5,!0),n(l.instalacao,!0),p="instalacao"):(C("correcao"),n(l.correcao,!0),p="correcao"));break;case"correcao":$("medidas"),F("instalacao"),n(u.step3,!1),n(l.correcao,!1),g.length>0?(Z(),Y()):(n(u.step5,!0),n(l.instalacao,!0),p="instalacao");break;case"instalacao":$("instalacao"),n(u.step5,!1),n(l.instalacao,!1),k&&(ne(),Z()),Y();break}},Y=()=>{k||ea(),Ze.style.display="none",ut(g[g.length-1]),G(""),ot.style.display="flex"},ha=e=>{e.inicio==="Cortina"&&(_e.style.display="flex",Me.style.display="none",Oe.style.display="none",W.tecido.textContent=e.tecido,W.tipo.textContent=e.tipo,W.bainha.textContent=e.tipo==="Ondas"||e.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",W.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",W.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",W.correcao.textContent=g[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",W.calha.textContent=e.calha,W.suporte.textContent="Suporte de "+e.suporte,W.instalacao.textContent=g[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio.startsWith("Estore")&&(Me.style.display="flex",_e.style.display="none",Oe.style.display="none",W.estoreProduto.textContent=e.tecido,W.estoreLargura.textContent=e.medidas.split(" X ")[0]+"cm",W.estoreAltura.textContent=e.medidas.split(" X ")[1]+"cm",W.estoreCorrecao.textContent=g[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",W.estoreInstalacao.textContent=g[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio==="Toalha"&&(Oe.style.display="flex",_e.style.display="none",Me.style.display="none",W.toalhaProduto.textContent=e.tecido,W.toalhaForma.textContent=e.forma,W.toalhaBainha.textContent=e.bainha,W.toalhaLargura.textContent=e.medidas.split(" X ")[0]+"cm",W.toalhaAltura.textContent=e.medidas.split(" X ")[1]+"cm",W.toalhaMargem.textContent=e.medidas.split(" X ")[2]+"cm")},fa=e=>{e.inicio==="Cortina"&&($("tecido"),$("tipo"),$("medidas"),$("calha"),$("instalacao")),e.inicio.startsWith("Estore")&&($("tecido"),$("medidas"),$("instalacao"))},ut=e=>{g.forEach(t=>{t.button&&t.button.classList.remove("active")}),N=e.index,k=!1,e.button.classList.add("active"),ha(e),wt(e),da(e),fa(e)},mt=e=>{ot.style.display="none",k&&pt(),G(""),Ze.style.display="flex";let t=!1,s=!1;switch((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||i.inicio==="Estore")&&(t=!0),i.inicio==="Toalha"&&(s=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura")&&(e="medidas"),(e==="estoreCorrecao"||e==="correcao")&&(e="medidas"),(e==="estoreInstalacao"||e==="instalacao")&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),G(t?"Estore":s?"Toalha":"Cortina"),e){case"inicio":C("inicio"),n(u.step1,!0),n(l.inicio,!0);break;case"tecido":i.inicio==="Estore Japon\xEAs"?S("Cortina"):S(t?"Estore":"Cortina"),setTimeout(()=>{},2e3),Xe(i.tecido),C("tecido"),n(u.step1,!0),n(l.tecido,!0);break;case"tipo":C("tipo"),n(u.step2,!0),n(l.tipo,!0);break;case"toalhaProduto":S("Toalha"),C("tecido"),n(u.step1,!0),n(l.tecido,!0);break;case"toalhaForma":C("forma"),n(u.step2toalha,!0),n(l.forma,!0);break;case"toalhaMedidas":C("medidas"),n(u.step3,!0),n(l.medidas,!0);break;case"medidas":C("medidas"),n(u.step3,!0),n(l.medidas,!0);break;case"calha":i.tipo==="Ilh\xF3s"?S("Var\xE3o"):S("Calha"),C("calha"),n(u.step4,!0),n(l.tecido,!0);break;case"suporte":C("suporte"),n(u.step4,!0),n(l.suporte,!0);break;case"instalacao":C("instalacao"),n(u.step5,!0),n(l.instalacao,!0);break}if(p=e,p==="inicio")return F("tecido");p==="toalhaProduto"&&(p="tecido"),t&&((e==="medidas"||e==="correcao")&&F("medidasEstore"),e==="instalacao"&&F("instalacaoEstore")),k=!1,F(e)},fo=async e=>{let t=Buffer.from(e,"base64"),o=await(await PDFDocument.load(t)).save();return Buffer.from(o).toString("base64")},po=async e=>await(await fetch(e)).arrayBuffer(),pa=(e,t,s,o,a,c,d)=>{let r=c.getPageCount(),h="www.fabricstore.pt",P=c.getPages();P.forEach(E=>{let x=`Pag. ${P.indexOf(E)+1} de ${r}`,A=d.widthOfTextAtSize(x,8),z=(E.getWidth()-A)/2;E.drawLine({start:{x:a,y:e-4*t},end:{x:s,y:e-4*t},thickness:.5,color:o(0,0,0)}),E.drawText(h,{x:a,y:e-5*t,size:10,fontReg:d}),E.drawText(x,{x:z,y:e-5*t,size:8,fontReg:d})})},ya=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",ht=async()=>{let{PDFDocument:e,rgb:t}=PDFLib,s=await e.create(),o=s.addPage([595.28,841.89]),a=800,c=50,d=520,r=12,h=3,P=0,E=100,b=await s.embedFont(PDFLib.StandardFonts.Helvetica),x=await s.embedFont(PDFLib.StandardFonts.HelveticaBold),A=a,z=null;try{z=await ga(At);let B=await fetch(z).then(ee=>ee.arrayBuffer()),V=await s.embedPng(B),{width:zt,height:ce}=V.scale(1),le=100,xe=ce/zt*le,Fe=(o.getWidth()-le)/2;o.drawImage(V,{x:Fe,y:A-10,width:le,height:xe})}catch(B){console.error("Error loading logo:",B)}let w="Cliente:",Se="Data:",bt="Email:",vt="Vendedor:",Ct="Loja:",wa=x.widthOfTextAtSize(w,8),It=x.widthOfTextAtSize(Se,8),eo=x.widthOfTextAtSize(bt,8),Bt=x.widthOfTextAtSize(vt,8),Tt=x.widthOfTextAtSize(Ct,8),kt=new Date().toLocaleDateString(),to=i.vendedor,Lt=ya(i.loja),ao=b.widthOfTextAtSize(kt,8),oo=b.widthOfTextAtSize(to,8),so=b.widthOfTextAtSize(Lt,8);o.drawText(w,{x:c,y:A,size:8,font:x}),o.drawText(`${i.nome}`,{x:c+wa+2,y:A,size:8,font:b});let io=It+ao+2,$t=d-io;o.drawText(Se,{x:$t,y:A,size:8,font:x}),o.drawText(kt,{x:$t+It+2,y:A,size:8,font:b});let R=A-r;o.drawText(bt,{x:c,y:R,size:8,font:x}),o.drawText(`${i.email}`,{x:c+eo+2,y:R,size:8,font:b});let no=Bt+oo+2,Wt=d-no;o.drawText(vt,{x:Wt,y:R,size:8,font:x}),o.drawText(`${i.vendedor}`,{x:Wt+Bt+2,y:R,size:8,font:b});let Qe=R-r,co=Tt+so+2,Pt=d-co;o.drawText(Ct,{x:Pt,y:Qe,size:8,font:x}),o.drawText(`${Lt}`,{x:Pt+Tt+2,y:Qe,size:8,font:b}),a=Qe-r*2,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,g.forEach(async(B,V)=>{(a<264+E&&B.inicio==="Cortina"||a<102+E&&B.inicio.startsWith("Estore"))&&(o=s.addPage([595.28,841.89]),a=800,a=R-r*2,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r);let{usedWidth:zt,tecido:ce,calha:le,instalacao:xe,total:Fe}=gt(B);P+=Fe;let ee=[];B.inicio==="Toalha"&&(o.drawText(`Toalha ${V+1} -`,{x:c,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:c+x.widthOfTextAtSize(`Janela ${V+1} -`,8),y:a,size:8,font:b}),a-=r,ee=[{label:"Toalha",price:ce,subItems:[{label:`Tipo de tecido: ${B.tecido}`},{label:`Forna da toalha: ${B.tipo}`},{label:`Ba\xEDnha: ${B.bainha}`}]}]),B.inicio==="Cortina"&&(o.drawText(`Janela ${V+1} -`,{x:c,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:c+x.widthOfTextAtSize(`Janela ${V+1} -`,8),y:a,size:8,font:b}),a-=r,ee=[{label:"Cortinado",price:ce,subItems:[{label:`Tipo de tecido: ${B.tecido}`},{label:`Modelo de cortina: ${B.tipo}`},{label:`Ba\xEDnha de chumbo: ${B.tecido.startsWith("9")?"Inclu\xEDda":B.bainha?"Sim":"N\xE3o"}`}]},{label:`${B.tipo==="Ilh\xF3s"?"Var\xE3o":"Calha"}`,price:le,subItems:[{label:`${B.tipo==="Ilh\xF3s"?"Modelo de var\xE3o":"Modelo de calha"}: ${B.calha}`},{label:`${B.tipo==="Ilh\xF3s"?"Suporte de var\xE3o":"Suporte da calha"}: ${B.tipo==="Ilh\xF3s"?"Parede":B.suporte}`}]},{label:"Instala\xE7\xE3o",price:xe,subItems:[]}]),B.inicio==="Estore"&&(o.drawText(`Janela ${V+1} -`,{x:c,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:c+x.widthOfTextAtSize(`Janela ${V+1} -`,8),y:a,size:8,font:b}),a-=r,ee=[{label:"Estore",price:ce,subItems:[{label:`Modelo de estore: ${B.tecido}`}]},{label:"Instala\xE7\xE3o",price:xe,subItems:[]}]),B.inicio==="Estore Japon\xEAs"&&(o.drawText(`Janela ${V+1} -`,{x:c,y:a,size:8,font:x}),o.drawText(` ${B.medidas} CM`,{x:c+x.widthOfTextAtSize(`Janela ${V+1} -`,8),y:a,size:8,font:b}),a-=r,ee=[{label:"Estore Japon\xEAs",price:ce+le,subItems:[{label:`Modelo de estore: ${B.tecido}`}]},{label:"Instala\xE7\xE3o",price:xe,subItems:[]}]),ee.forEach(ze=>{o.drawText(`  - ${ze.label}`,{x:c,y:a,size:8,font:x}),o.drawText(`${ze.price.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:b}),a-=r,ze.subItems.forEach(uo=>{o.drawText(`      \u2022 ${uo.label}`,{x:c+20,y:a,size:8,font:b}),a-=r}),a-=r}),o.drawText("Total",{x:c,y:a,size:8,font:x}),o.drawText(`${Fe.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontReg:b}),a-=r,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r}),a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=R-r*2,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r);let lo=g[0].correcao?"Sim":"Facultadas pelo cliente";o.drawText("Retifica\xE7\xE3o de medidas:",{x:c,y:a,size:8,font:x}),o.drawText(lo,{x:c+x.widthOfTextAtSize("Retifica\xE7\xE3o de medidas:",8)+2,y:a,size:8,font:b});let St=g[0].correcao?30:0;P+=St,o.drawText(`${St.toFixed(2)}\u20AC`,{x:d-100,y:a,size:8,fontReg:b}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r*2,a<38+E&&(o=s.addPage([595.28,841.89]),a=800,a=R-r*2,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r),o.drawText("Total:",{x:d-150,y:a,size:10,font:x}),o.drawText(`${P.toFixed(2)}\u20AC`,{x:d-100,y:a,size:10,fontBold:x}),a<108+E&&(o=s.addPage([595.28,841.89]),a=800,a=R-r*2,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r,o.drawText("Descri\xE7\xE3o",{x:c,y:a,size:8,font:x}),o.drawText("Pre\xE7o",{x:d-100,y:a,size:8,font:x}),a-=r-4,a-=h,o.drawLine({start:{x:c,y:a},end:{x:d,y:a},thickness:.5,color:t(0,0,0)}),a-=h+r),a-=r*4,o.drawText("Observa\xE7\xF5es:",{x:c,y:a,size:10,font:x});let ye="\u2022 ",ge=10;o.drawText(`${ye}Valores com IVA incluido \xE0 taxa em vigor. Or\xE7amento v\xE1lido por 15 dias.`,{x:c+ge,y:a-r,size:8,font:b}),o.drawText(`${ye}Calhas j\xE1 incluem os rod\xEDzios e suportes necess\xE1rios para as medidas selecionadas.`,{x:c+ge,y:a-2*r,size:8,font:b}),o.drawText(`${ye}Valor referente \xE0 instala\xE7\xE3o e rectifica\xE7\xE3o de medidas sujeito a valida\xE7\xE3o do c\xF3digo postal.`,{x:c+ge,y:a-3*r,size:8,font:b}),o.drawText(`${ye}Valor da Rectifica\xE7\xE3o de Medidas \xE9 deduzido do or\xE7amento na adjudica\xE7\xE3o do mesmo.`,{x:c+ge,y:a-4*r,size:8,font:b}),o.drawText(`${ye}IBAN: PT50 0007 0000 0041 4543 3722 3`,{x:c+ge,y:a-5*r,size:8,font:b}),pa(E,r,d,t,c,s,b);let ro=await s.save(),Ft=new Blob([ro],{type:"application/pdf"}),Ge=document.createElement("a");return Ge.href=URL.createObjectURL(Ft),Ge.download="Orcamento_Fabric-Store.pdf",{blob:Ft,pdfDoc:s,link:Ge}},ft=async()=>{let e=0,t="";t+=`Data: ${new Date().toLocaleDateString()}

`,t+=`Cliente: ${i.nome}

`,t+=`Email: ${i.email}

`;let s=g[0].correcao?"  Sim:":"  Facultadas pelo cliente:",o=g[0].correcao?30:0;return g.forEach((c,d)=>{let{usedWidth:r,tecido:h,calha:P,instalacao:E,total:b}=gt(c);e+=b,c.inicio==="Cortina"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${b.toFixed(2)}\u20AC

`,t+=`  Cortinado: ${h.toFixed(2)}\u20AC
`,t+=`    Tipo de tecido: ${c.tecido}
`,t+=`    Modelo de Cortina: ${c.tipo}
`,t+=`    Ba\xEDnha de chumbo: ${c.tecido.startsWith("9")?"Inclu\xEDda":c.bainha?"Sim":"N\xE3o"}

`,t+=`  Calha: ${P.toFixed(2)}\u20AC
`,t+=`    Modelo de calha: ${c.tipo}
`,t+=`    Suporte da calha: ${c.suporte}

`),c.inicio==="Estore"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${b.toFixed(2)}\u20AC

`,t+=`  Estore: ${h.toFixed(2)}\u20AC
`,t+=`    Modelo de estore: ${c.tecido}

`),c.inicio==="Estore Japon\xEAs"&&(t+=`Janela ${d+1} - ${c.medidas} CM: ${b.toFixed(2)}\u20AC

`,t+=`  Estore: ${parseFloat(h.toFixed(2))+parseFloat(P.toFixed(2))}\u20AC
`,t+=`    Modelo de estore: ${c.tecido}

`),c.inicio==="Toalha"&&(t+=`Toalha ${d+1} - ${c.medidas} CM: ${b.toFixed(2)}\u20AC

`,t+=`  Toalha: ${h.toFixed(2)}\u20AC
`,t+=`    Tecido: ${c.tecido}
`,t+=`    Forma: ${c.forma}
`,t+=`    Largura: ${c.medidas.split(" X ")[0]}cm
`,t+=`    Altura: ${c.medidas.split(" X ")[1]}cm
`,t+=`    Margem: ${c.medidas.split(" X ")[2]}cm
`),t+=`  Instala\xE7\xE3o: ${E.toFixed(2)}\u20AC

`}),t+=`Retifica\xE7\xE3o de medidas:
${s} ${o.toFixed(2)}\u20AC

`,e+=o,t+=`Total: ${e.toFixed(2)}\u20AC

`,new Blob([t],{type:"text/plain"})},ga=e=>new Promise((t,s)=>{let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{let a=document.createElement("canvas");a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0);let d=a.toDataURL("image/png");t(d)},o.onerror=a=>{s(new Error(`Failed to load image from ${e}: ${a.message}`))}}),G=e=>{e||(Ee.style.display="none",be.style.display="none",ve.style.display="none"),e==="Cortina"&&(Ee.style.display="flex",be.style.display="none",ve.style.display="none"),e==="Estore"&&(Ee.style.display="none",be.style.display="flex",ve.style.display="none"),e==="Toalha"&&(Ee.style.display="none",be.style.display="none",ve.style.display="flex")},xa=()=>{gsap.registerPlugin(ScrollToPlugin),gsap.to(window,{duration:1,scrollTo:{y:0},ease:"power2.inOut"})},n=(e,t)=>{t?gsap.fromTo(e,{opacity:0},{opacity:1,duration:.8,delay:.4,ease:"power2.inOut",onStart:()=>{e.style.display="flex"}}):gsap.to(e,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>{e.style.display="none",xa()}})},pt=()=>{Object.keys(f).forEach(e=>{f[e].classList.remove("active"),f[e].classList.add("next"),f[e].classList.remove("done"),f[e].getElementsByClassName("step_number")[0].classList.remove("active"),f[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},$=e=>{f[e].classList.remove("active"),f[e].classList.remove("next"),f[e].classList.add("done"),f[e].getElementsByClassName("step_number")[0].classList.remove("active"),f[e].getElementsByClassName("step_description")[0].classList.contains("next")&&f[e].getElementsByClassName("step_description")[0].classList.remove("next"),f[e].getElementsByClassName("step_description")[0].textContent=i[e],e==="instala\xE7\xE3o"&&(f.instalacaoEstore?.classList.remove("active"),f.instalacaoEstore?.classList.remove("next"),f.instalacaoEstore?.classList.add("done"),f.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),f.instalacaoEstore.getElementsByClassName("step_description")[0].textContent=i.instalacao?"c/Instala\xE7\xE3o":"s/Instala\xE7\xE3o"),e==="medidas"&&(g.length>0?f[e].getElementsByClassName("step_description")[0].innerHTML+=g[0].correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o":f[e].getElementsByClassName("step_description")[0].innerHTML+=i.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o",f.medidasEstore?.classList.remove("active"),f.medidasEstore?.classList.remove("next"),f.medidasEstore?.classList.add("done"),f.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),f.medidasEstore.getElementsByClassName("step_description")[0].textContent=`${v?.value} X ${L?.value}cm`,f.medidasEstore.getElementsByClassName("step_description")[0].innerHTML+=`${i.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o"}`),e==="medidasToalha"&&(f.medidasToalha?.classList.remove("active"),f.medidasToalha?.classList.remove("next"),f.medidasToalha?.classList.add("done"),f.medidasToalha?.getElementsByClassName("step_number")[0].classList.remove("active"),i.forma==="Redonda"||i.forma==="Quadrada"?f.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${v?.value} X ${v?.value} X ${_?.value} cm`:f.medidasToalha.getElementsByClassName("step_description")[0].textContent=`${v?.value} X ${L?.value} X ${_?.value} cm`),e==="tipo"&&(f[e].getElementsByClassName("step_description")[0].innerHTML+=`${i.bainha?"<br>c/Ba\xEDnha de Chumbo":"<br>s/Ba\xEDnha de Chumbo"}`)},F=e=>{let t=e==="toalhaProduto"?"tecido":e;f[t].classList.remove("next"),f[t].classList.add("active"),f[t].getElementsByClassName("step_number")[0].classList.add("active"),t==="instalacao"&&(f.instalacaoEstore?.classList.remove("next"),f.instalacaoEstore?.classList.add("active"),f.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.add("active")),t==="medidas"&&(f.medidasEstore?.classList.remove("next"),f.medidasEstore?.classList.add("active"),f.medidasEstore?.getElementsByClassName("step_number")[0].classList.add("active"))},Ea=e=>{let t=e;if(t==="suporte"&&(t="calha"),f[t].classList.contains("active")&&(f[t].classList.remove("active"),f[t].getElementsByClassName("step_number")[0].classList.remove("active")),t==="instalacao"&&(f.instalacaoEstore?.classList.remove("active"),f.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),t==="medidas"&&(f.medidasEstore?.classList.remove("active"),f.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),!k||T())return $(t);f[t].classList.add("next"),f[t].querySelector("step_description")&&!f[t].querySelector("step_description")[0].classList.contains("next")&&f[t].querySelector("step_description")[0].classList.add("next"),t==="instalacao"&&f.instalacaoEstore?.classList.add("next"),t==="medidas"&&f.medidasEstore?.classList.add("next")},m=e=>{e&&me?.classList.contains("inactive")&&me.classList.remove("inactive"),e||me?.classList.contains("inactive")||me.classList.add("inactive")},je=e=>{e.classList.add("active")},Je=e=>{e.classList.remove("active")},K=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),s.classList.add("active")},D=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),s.classList.remove("active")},yo=e=>{e.classList.add("show"),gsap.fromTo(e,{opacity:0},{opacity:1,duration:1,ease:"power1.in"})},go=e=>{e.classList.add("show"),gsap.fromTo(e,{x:-100,opacity:0},{x:0,opacity:1,duration:1,ease:"power1.inOut"})},xo=(e,t=0)=>{gsap.fromTo(e.map(s=>`#${s}`),{opacity:0,x:-300},{opacity:1,x:0,duration:1,ease:"power1.inOut",stagger:t})},ba=e=>{e==="Toalha"?(Ye.style.display="flex",we.style.display="none"):(Ye.style.display="none",we.style.display="block")},va=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.getElementsByTagName("h1")[0].textContent;K(t),e.forEach(o=>{o!==t&&D(o)}),S(s),ba(s),I(l.inicio,s),T()&&m(!0)})})},Ca=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(s=>{s.addEventListener("click",()=>{let o=lt(s),a=ia(s),c=Ae.find(r=>r.product===o),d=s.getElementsByClassName("tecido_color");if(t.forEach(r=>Je(r)),K(s,l.tecido),e.forEach(r=>{r!==s&&D(r)}),c){for(let r=0;r<d.length;r++)d.item(r).id===`${c.color}`&&je(d.item(r));p==="tecido"&&I(l.tecido,c.color),p==="calha"&&Ve(c.color)}else d.length>0&&je(d[0]),p==="tecido"&&a!==""&&I(l.tecido,`${a}`),p==="calha"&&a!==""&&Ve(a);T()&&m(!0)})})},Ia=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",s=>{let o=s.currentTarget,a=o&&o.id;je(o),e.forEach(h=>{h!==o&&Je(h)});let c=a?a.split("-")[0]:"",d=Ae.find(h=>h.product===c);d?d.color=`${a}`:Ae.push({product:c,color:`${a}`});let r=o.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let h=0;h<e.length;h++)if(e[h].getAttribute("id")===a){let P=e[h].querySelector(".source");P?r.setAttribute("src",P.getAttribute("src")):r.setAttribute("src",e[h].getElementsByTagName("img")[0].getAttribute("src")),r.setAttribute("srcset","");break}return p==="calha"&&a!==""?Ve(a):p==="tecido"&&a!==""?I(l.tecido,a):console.log("No color was stored")})})},Ba=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{K(t,l.tipo),e.forEach(s=>{s!==t&&D(s)}),I(l.tipo,t.getElementsByTagName("h1")[0].textContent),T()&&m(!0)})})},Ta=()=>{let e=document.querySelectorAll("[id^='forma-card']");e.forEach(t=>{t.addEventListener("click",()=>{K(t),e.forEach(s=>{s!==t&&D(s)}),I(l.forma,t.getElementsByTagName("h1")[0].textContent),T()&&m(!0)})})},ka=()=>{let e=document.querySelectorAll("[id^='bainha-card']");e.forEach(t=>{t.addEventListener("click",()=>{K(t),e.forEach(s=>{s!==t&&D(s)}),I(l.bainha,t.getElementsByTagName("h1")[0].textContent),T()&&m(!0)})})},La=()=>{Le.addEventListener("change",function(e){I(l.bainha,Le.checked)})},$a=()=>{X?.addEventListener("change",e=>{(X?.checked===!0||de?.checked===!0)&&(ct("Parede"),T()&&m(!0))}),de?.addEventListener("change",e=>{(X?.checked===!0||de?.checked===!0)&&(ct("Tecto"),T()&&m(!0))})},Wa=()=>{_?.addEventListener("input",e=>{if(i.inicio==="Toalha"){if(i.forma==="Quadrada"||i.forma==="Redonda"){if(v?.value===""||_?.value===""){m(!1);return}}else if(v?.value===""||L?.value===""||_?.value===""){m(!1);return}}else if(v?.value===""||L?.value===""){m(!1);return}T()&&I(l.medidas,`${v?.value} X ${L?.value}`),v?.value!==""&&L?.value!==""&&(T()?m(!0):m(!1))}),v?.addEventListener("input",e=>{if(i.inicio==="Toalha"){if(i.forma==="Quadrada"||i.forma==="Redonda"){if(v?.value===""||_?.value===""){m(!1);return}}else if(v?.value===""||L?.value===""||_?.value===""){m(!1);return}}else if(v?.value===""||L?.value===""){m(!1);return}T()&&I(l.medidas,`${v?.value} X ${L?.value}`),v?.value!==""&&L?.value!==""&&(T()?m(!0):m(!1))}),L?.addEventListener("input",e=>{if(i.inicio==="Toalha"){if(v?.value===""||L?.value===""||_?.value===""){m(!1);return}}else if(v?.value===""||L?.value===""){m(!1);return}T()&&I(l.medidas,`${v?.value} X ${L?.value}`),v?.value!==""&&L?.value!==""&&(T()?m(!0):m(!1))})},Pa=()=>{re.addEventListener("change",function(e){I(l.correcao,re.checked)})},Sa=()=>{ue.addEventListener("change",function(e){I(l.instalacao,ue.checked)})},Fa=()=>{Object.keys(f).forEach(e=>{f[e].addEventListener("click",()=>{ua(e)})})},za=()=>{Object.keys(W).forEach(e=>{W[e].addEventListener("click",()=>{e==="correcao"||e==="estoreCorrecao"||e!=="suporte"&&e!=="bainha"&&mt(e)})})},yt=e=>{e.button.addEventListener("click",()=>{ut(e)})},Aa=()=>{Rt.addEventListener("click",async()=>{i.nome=$e.value,i.email=We.value,i.contacto=at.checked,window.location.href.includes(Ke)&&(i.loja=Pe.value.trim(),i.vendedor=he.value.trim());let e=await ft(),{blob:t,pdfDoc:s,link:o}=await ht();q.push({blob:t,pdf:s,link:o}),q[q.length-1].link.click()})},Ma=()=>{Xt.addEventListener("click",async()=>{i.nome=$e.value,i.email=We.value,i.contacto=at.checked,window.location.href.includes(Ke)&&(i.loja=Pe.value.trim(),i.vendedor=he.value.trim());let{blob:e,pdfDoc:t,link:s}=await ht();q.push({blob:e,pdf:t,link:s});let o=await ft();await Ya(i.nome,i.email,i.contacto?"Aceita":"N\xE3o aceita",q[q.length-1].blob,o,q[q.length-1].link)})},_a=()=>{Dt.addEventListener("click",ta)},Oa=()=>{Vt.addEventListener("click",()=>{Ot.style.display="none",Nt.style.display="flex"})},Na=()=>{me.addEventListener("click",ma)},Da=()=>{let e=[];_t.querySelectorAll(".vendedor_data").forEach(o=>{e.push({name:o.querySelector(".vendedor_name").textContent.trim(),loja:o.querySelector(".vendedor_loja").textContent.trim()})});function s(o){he.innerHTML="";let a=e.filter(d=>d.loja===o),c=document.createElement("option");c.value="",c.textContent="Selecione um Vendedor",he.appendChild(c),a.forEach(d=>{let r=document.createElement("option");r.value=d.name,r.textContent=d.name,he.appendChild(r)})}Pe.addEventListener("change",function(){let o=Pe.value.trim();s(o)})},Va=e=>{if(e.inicio==="Toalha"){let s=e.medidas.split(" X "),[o,a,c]=s.map(P=>parseInt(P)),d=Math.max(o,a),r=Math.min(o,a),h=e.bainha.includes("Cantos")?y.bainhaToalhas.cantos.widthMargin:y.bainhaToalhas.normal.widthMargin;return d+2*c+h<=y.maxWidthToalhas?r+2*c+h:d+2*c+h}if(e.inicio==="Estore Japon\xEAs")return e.medidas?parseInt(e.medidas.split(" X ")[0]):0;let t=y.usedWidths.find(s=>e.tipo===s.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+y.bainhaPrice.widthMargin:0},Xa=(e,t)=>{let s=e.medidas.split(" X ")[0],o=0,a=0,c=Kt(e);return e.inicio==="Toalha"&&(o=c.product*(t/100)),e.inicio==="Cortina"&&(o=c.product*(t/100),a=c.calha),e.inicio==="Estore"&&(o=c.product),e.inicio==="Estore Japon\xEAs"&&(o=c.product*((t+y.bainhaEstoreJaponesPrice.widthMargin)/100),a=c.calha),{product:o,calha:a}},Ra=(e,t)=>{if(e.inicio==="Toalha"){let o=e.forma==="Redonda"?"circle":e.forma==="Quadrada"?"square":"retangle",a=e.bainha.includes("Cantos")?"cantos":"normal",c=y.manufacturingPrices.towels[o][a],d=c.find(z=>t<=z.maxWidth),r=e.medidas.split(" X "),[h,P,E]=r.map(z=>parseInt(z)),b=Math.max(h,P),x=Math.min(h,P),A=e.bainha.includes("Cantos")?y.bainhaToalhas.cantos.widthMargin:y.bainhaToalhas.normal.widthMargin;if(x+2*E+A<=y.maxWidthToalhasNoPriceIncrease)return d?d.price:0;{let z=c.findIndex(Se=>t<=Se.maxWidth),w=z+1<c.length?c[z+1]:c[z];return w?w.price:0}return d?d.price:0}if(e.inicio==="Estore")return 0;if(e.inicio==="Estore Japon\xEAs"){let o=e.medidas.split(" X ")[0],a=e.medidas.split(" X ")[1],c=parseInt(o)/100*(parseInt(a)/100);return c?c*y.manufacturingPrices.japaneseBlind:0}let s=y.manufacturingPrices.curtains.find(o=>e.tipo===o.name);return s?e.tecido.startsWith("8")?s.blackout*(t/100):e.tecido.startsWith("9")&&(e.tipo==="Ondas"||e.tipo==="Franzido")?s.alinhado*(t/100):s.normal*(t/100):0},qa=(e,t)=>e.inicio==="Toalha"||e.inicio==="Cortina"&&e.tecido.startsWith("9")||e.inicio.startsWith("Estore")?0:e.bainha?y.bainhaPrice.price*(t/100):0,Eo=e=>e.inicio==="Toalha"?0:e.correcao?y.measuresCheckPrice:0,ja=e=>{if(e.inicio==="Toalha"||!g[0].instalacao)return 0;let t=0,s=parseInt(e.medidas.split(" X ")[0]),o=y.instalation.find(a=>s<=a.maxWidth);return o&&(t=o.price),o&&e.inicio==="Cortina"&&e.calha.startsWith("9500")&&(t*=2),t||0},gt=e=>{let t=Va(e),s=Xa(e,t),o=Ra(e,t),a=qa(e,t),c=ja(e),d=s.product+o+a+s.calha+c;return e.totalPrice=d,{usedWidth:t,tecido:s.product+o+a,calha:s.calha,instalacao:c,total:d}},Ja=e=>{let t=e.indexOf("@");return t>0&&t<e.length-1},He=e=>new Promise((t,s)=>{let o=new FileReader;o.onloadend=()=>t(o.result),o.onerror=s,o.readAsDataURL(e)}),Ha=()=>$e.value.trim()===""?(ie.textContent="Preencher este campo obrigat\xF3rio",ie.classList.add("u-text-main"),!0):(ie.textContent="",ie.classList.remove("u-text-main"),!1),Ua=()=>{let e=We.value.trim();return e===""?(Q.textContent="Preencher este campo obrigat\xF3rio",Q.classList.add("u-text-main"),!0):Ja(e)?(Q.textContent="",Q.classList.remove("u-text-main"),!1):(Q.textContent="Insira um email v\xE1lido",Q.classList.add("u-text-main"),!0)},Ue=()=>{Ga();let e=Ha(),t=Ua();Ka(e||t),Za(e||t)},Qa=()=>{$e?.addEventListener("input",Ue),We?.addEventListener("input",Ue)},Ga=()=>{ie.textContent="",Q.textContent="",nt.textContent="",ie.classList.remove("u-text-main"),Q.classList.remove("u-text-main"),nt.classList.remove("u-text-main")},Ka=e=>{e&&st?.classList.add("inactive"),e||st?.classList.remove("inactive")},Za=e=>{e&&it?.classList.add("inactive"),e||it?.classList.remove("inactive")},bo=async e=>{let t=null;try{let o=await e;t=await He(o)}catch{console.error("Failed to load txt"),t=null}let s={name:i.nome,email:i.email,check:i.contacto?"Aceita":"N\xE3o aceita",file:t,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_txt",s).then(function(o){console.log("TXT DL SUCCESS!",o.status,o.text)},function(o){console.log("TXT DL FAILED...",o)})},Ya=async(e,t,s,o,a,c)=>{let d=null,r=null;try{let E=await o,b=await a;d=await He(E),r=await He(b)}catch{console.error("Failed to load PDF"),d=null}let h={name:e,email:t,check:s,file:d,to_company_email:"contact@fabricstore.pt",to_user_email:t,reply_to:"contact@fabricstore.pt"},P={name:e,email:t,check:s,file:r,to_company_email:"contact@fabricstore.pt",reply_to:"contact@fabricstore.pt"};emailjs.send("service_fabricstore","template_quote_pdf",h).then(function(E){console.log("PDF EMAIL SUCCESS!",E.status,E.text),Mt.style.display="none",Ne.style.display="none",De.textContent="Obrigado pelo seu contacto!",De.style.display="block"},function(E){console.log("PDF EMAIL FAILED...",E),De.style.display="none",Ne.textContent="Aconteceu um erro durante o envio. Tente novamente ou entre em contacto connosco.",Ne.style.display="block"}),emailjs.send("service_fabricstore","template_quote_txt",P).then(function(E){console.log("TXT SUCCESS!",E.status,E.text)},function(E){console.log("TXT FAILED...",E)})},xt={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},Et=new Swiper(".swiper",xt),pe=()=>{Et.destroy(),Et=new Swiper(".swiper",xt)};Gt()});})();
